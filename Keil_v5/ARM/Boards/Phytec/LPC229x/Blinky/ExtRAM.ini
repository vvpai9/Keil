/***********************************************************************/
/*  This file is part of the ARM Compiler package                      */
/*  Copyright KEIL ELEKTRONIK GmbH 1992-2004                           */
/***********************************************************************/
// <<< Use Configuration Wizard in Context Menu >>>                    // 
/***********************************************************************/
/*                                                                     */
/*  ExtRAM.INI: External RAM Initialization File                       */
/*                                                                     */
/***********************************************************************/

FUNC void cpyVect2RAM(void) {
  unsigned int i;
  for (i=0; i<64;i=i+4) {
    _WDWORD((0x40000000+i), _RDWORD((0x81000000)+i));
  }
}


FUNC void Setup (void) {
// <h> External Memory Controller (EMC)

//   <h> Bank Configuration 1 (BCFG1)
//     <o1.0..3>   IDCY: Idle Cycles <0-15>
//     <o1.5..9>   WST1: Wait States 1 <0-31>
//     <o1.11..15> WST2: Wait States 2 <0-31>
//     <o1.10>     RBLE: Read Byte Lane Enable
//     <o1.26>     WP: Write Protect
//     <o1.27>     BM: Burst ROM
//     <o1.28..29> MW: Memory Width  <0=>  8-bit  <1=> 16-bit
//                                   <2=> 32-bit  <3=> Reserved
//   </h>
  _WDWORD(0xFFE00004, 0x20003CE3);   // BCFG1: Flash Bus Configuration

  _WDWORD(0xE002C014, 0x0E6049E4);   // PINSEL2: CS0, OE, WE, BLS0..3
                                     //          D0..31, A2..23, JTAG

// </h>
}

Setup();                             // Setup for Running

LOAD phy\blinky.axf INCREMENTAL      // Download

cpyVect2RAM();                       // copy vectors to RAM
                                     // remapping is done in Startup.s
PC = 0x81000000;                     // set PC to start
g, main								               // Go til main
