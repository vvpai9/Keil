<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>CMSIS Driver: Peripheral Driver Interfaces</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="cmsis.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="stylsheetf" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 46px;">
  <td id="projectlogo"><img alt="Logo" src="CMSIS_Logo_Final.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">CMSIS Driver
   &#160;<span id="projectnumber">Version 1.10 - Preliminary</span>
   </div>
   <div id="projectbrief">Middleware Driver API for microcontroller peripherals</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<div id="CMSISnav" class="tabs1">
    <ul class="tablist">
      <li><a href="../../General/html/index.html"><span>CMSIS</span></a></li>
      <li><a href="../../Core/html/index.html"><span>CORE</span></a></li>
      <li class="current"><a href="../../Driver/html/index.html"><span>Driver</span></a></li>
      <li><a href="../../DSP/html/index.html"><span>DSP</span></a></li>
      <li><a href="../../RTOS/html/index.html"><span>RTOS API</span></a></li>
      <li><a href="../../Pack/html/index.html"><span>Pack</span></a></li>
      <li><a href="../../SVD/html/index.html"><span>SVD</span></a></li>
    </ul>
</div>
<!-- Generated by Doxygen 1.8.2 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li class="current"><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Reference</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('index.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Peripheral Driver Interfaces </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#DriverFunctions">Driver Functions</a></li>
<li class="level1"><a href="#CallSequence">Function Call Sequence</a></li>
<li class="level1"><a href="#History">Revision History</a></li>
</ul>
</div>
<div class="textblock"><p>Peripheral Driver Interfaces are implementations of published APIs. The APIs are Component Groups under the <b>Device</b> Class of a software component. Currently the CMSIS Pack publishes the Driver API Interface with one or more *.h header files and a documentation. It is intended to standardize these Peripheral Driver Interfaces as part of a future CMSIS release.</p>
<p>The actual implementation of each driver is provided in the Device Family Pack available for each microcontroller family. In a Device Family Pack the <b>Device</b> <b>Class</b> contains several software component Groups with Device Drivers for physical device peripherals that are typically used by middleware libraries.</p>
<div class="image">
<img src="Driver.png" alt="Driver.png"/>
<div class="caption">
Device Driver Interfaces and Configuration File</div></div>
<p> The following Device Driver interfaces are defined as API:</p>
<ul>
<li><a class="el" href="group__eth__interface__gr.html">Ethernet</a>: Interface to Ethernet MAC and PHY peripheral.</li>
<li><a class="el" href="group__i2c__interface__gr.html">I2C</a>: Multimaster Serial Single-Ended Bus interface driver.</li>
<li><a class="el" href="group__mci__interface__gr.html">MCI</a>: Memory Card Interface for SD/MMC memory.</li>
<li><a class="el" href="group__nand__interface__gr.html">NAND</a>: NAND Flash Memory interface driver.</li>
<li><a class="el" href="group__nor__interface__gr.html">NOR</a>: NOR Flash Memory interface driver.</li>
<li><a class="el" href="group__spi__interface__gr.html">SPI</a>: Serial Peripheral Interface Bus driver for 8-bit Master.</li>
<li><a class="el" href="group__uart__interface__gr.html">UART</a>: Universal Asynchronous Receiver/Transmitter interface driver.</li>
<li><a class="el" href="group__usb__interface__gr.html">USB</a>: USB driver interface for generic USB Host and Device communication.</li>
</ul>
<p>A specific Device Driver API does not support every potential use-case of a peripheral type. For example the Device Driver API Group <b>Ethernet</b> is not suitable for the Precision Time Protocol defined in IEEE1588. In a similar way the Device API Group <b>UART</b> does not support SmartCard interfaces. However, the defined API interfaces support a wide range of use cases. It is possible to extend a Device class with further Device API Groups to cover new use-cases.</p>
<p>A Device Family Pack may contain additional Peripheral Driver Interfaces to extend the standard Device Driver API Groups defined by a future CMSIS standard. For example, other supporting Peripheral Driver Interfaces for Memory BUS, GPIO, or DMA may be part of the Device Family Pack and referenced by the implementation of the standard Device Driver API Groups.</p>
<h1><a class="anchor" id="DriverFunctions"></a>
Driver Functions</h1>
<p>The driver implementations assumes the <b>CMSIS-RTOS</b> functionality and may use interrupts and DMA (direct memory access) available in the device. Each peripheral type that is accessed by a Driver publishes a struct that allows to access the functions of the driver. This struct type is named ARM_DRIVER_xxx and Function Access in the documentation.</p>
<p><b>Example: Function Access of the SPI driver</b> </p>
<div class="fragment"><div class="line"><span class="keyword">typedef</span> <span class="keyword">struct </span>_ARM_DRIVER_SPI {</div>
<div class="line">  <a class="code" href="group__common__drv__gr.html#struct_a_r_m___d_r_v___v_e_r_s_i_o_n" title="Driver Version.">ARM_DRV_VERSION</a>      (*GetVersion)     (void);</div>
<div class="line">  <a class="code" href="group__spi__interface__gr.html#struct_a_r_m___s_p_i___c_a_p_a_b_i_l_i_t_i_e_s" title="SPI Driver Capabilities.">ARM_SPI_CAPABILITIES</a> (*GetCapabilities)(void);</div>
<div class="line">  <a class="code" href="group__spi__interface__gr.html#ga2adb4efb07eca74ade7117f31403ff14" title="SPI Status of executed operation.">ARM_SPI_STATUS</a>       (*Initialize)     (<a class="code" href="group__spi__interface__gr.html#ga9557ca0415e40e64f5f9187d7a1670ec" title="Pointer to ARM_SPI_SignalEvent : Signal SPI Event.">ARM_SPI_SignalEvent_t</a> cb_event);</div>
<div class="line">  <a class="code" href="group__spi__interface__gr.html#ga2adb4efb07eca74ade7117f31403ff14" title="SPI Status of executed operation.">ARM_SPI_STATUS</a>       (*Uninitialize)   (void);</div>
<div class="line">  <a class="code" href="group__spi__interface__gr.html#ga2adb4efb07eca74ade7117f31403ff14" title="SPI Status of executed operation.">ARM_SPI_STATUS</a>       (*PowerControl)   (<a class="code" href="group__common__drv__gr.html#ga47d6d7c31f88f3b8ae4aaf9d8444afa5" title="General power states.">ARM_POWER_STATE</a> state);</div>
<div class="line">  <a class="code" href="group__spi__interface__gr.html#ga2adb4efb07eca74ade7117f31403ff14" title="SPI Status of executed operation.">ARM_SPI_STATUS</a>       (*Configure)      (<a class="code" href="group__spi__interface__gr.html#ga69420c5dc92ae1df4cb3a55972359c22" title="SPI Frame Format.">ARM_SPI_FRAME_FORMAT</a> frame_format, <a class="code" href="group__spi__interface__gr.html#ga0c8c2eab5ac04ce94039cc7efc79c4bb" title="SPI Bit Order.">ARM_SPI_BIT_ORDER</a> bit_order);</div>
<div class="line">  uint32_t             (*BusSpeed)       (uint32_t bps);</div>
<div class="line">  <a class="code" href="group__spi__interface__gr.html#ga2adb4efb07eca74ade7117f31403ff14" title="SPI Status of executed operation.">ARM_SPI_STATUS</a>       (*SlaveSelect)    (<a class="code" href="group__spi__interface__gr.html#ga8c53f76233cc4e32f54fbbfe274edc5e" title="SPI Slave Select Signal.">ARM_SPI_SS_SIGNAL</a> state);</div>
<div class="line">  uint8_t              (*TransferByte)   (uint8_t out);</div>
<div class="line">  <a class="code" href="group__spi__interface__gr.html#ga2adb4efb07eca74ade7117f31403ff14" title="SPI Status of executed operation.">ARM_SPI_STATUS</a>       (*SendData)       (<span class="keyword">const</span> uint8_t *buf, uint32_t len);</div>
<div class="line">  <a class="code" href="group__spi__interface__gr.html#ga2adb4efb07eca74ade7117f31403ff14" title="SPI Status of executed operation.">ARM_SPI_STATUS</a>       (*ReceiveData)    (uint8_t *buf, uint32_t len, uint8_t  out);</div>
<div class="line">  <a class="code" href="group__spi__interface__gr.html#ga2adb4efb07eca74ade7117f31403ff14" title="SPI Status of executed operation.">ARM_SPI_STATUS</a>       (*AbortTransfer)  (void);</div>
<div class="line">} <span class="keyword">const</span> <a class="code" href="group__spi__interface__gr.html#struct_a_r_m___d_r_i_v_e_r___s_p_i" title="Access structure of the SPI Driver.">ARM_DRIVER_SPI</a>;</div>
</div><!-- fragment --><p>A device may offer several peripherals of the same type. For such devices, a driver implementation publishes multiple instances of the driver access structure. The name of each driver instance reflects the names of the peripheral available in the device.</p>
<p><b>Example: SPI driver Function Access structs for 3 SPIs in a microcontroller device.</b> </p>
<div class="fragment"><div class="line"><a class="code" href="group__spi__interface__gr.html#struct_a_r_m___d_r_i_v_e_r___s_p_i" title="Access structure of the SPI Driver.">ARM_DRIVER_SPI</a> ARM_Driver_SPI1;     <span class="comment">// access functions for SPI1 interface</span></div>
<div class="line"><a class="code" href="group__spi__interface__gr.html#struct_a_r_m___d_r_i_v_e_r___s_p_i" title="Access structure of the SPI Driver.">ARM_DRIVER_SPI</a> ARM_Driver_SPI2;     <span class="comment">// access functions for SPI2 interface</span></div>
<div class="line"><a class="code" href="group__spi__interface__gr.html#struct_a_r_m___d_r_i_v_e_r___s_p_i" title="Access structure of the SPI Driver.">ARM_DRIVER_SPI</a> ARM_Driver_SPI3;     <span class="comment">// access functions for SPI3 interface</span></div>
</div><!-- fragment --><p>For a device family, the drivers are configurable and all configuration options are stored in a central file with the name <b>RTE_Device.h</b>. This file contains also configuration settings for the processor and peripheral clock. The <b>RTE_Device.h</b> may contain control strings for the MDK Configuration Wizard. However, the <b>RTE_Device.h</b> file may be also configured with silicon vendor specific configuration utilities.</p>
<p>Each Function Access struct of a driver contains these functions:</p>
<ul>
<li><b>GetVersion:</b> can be called at any time to obtain version information of the driver interface.</li>
</ul>
<ul>
<li><b>GetCapabilities:</b> can be called at any time to obtain capabilities of the driver interface.</li>
</ul>
<ul>
<li><b>Initialize:</b> must be called first. Initializes the software resources used by the interface (clear variables, allocate memory, create CMSIS-RTOS objects, ...). Initialize may also register a <b>SignalEvent</b> callback function. Initialize leaves the peripheral in powered-off state.</li>
</ul>
<ul>
<li><b>SignalEvent:</b> is an optional callback function registered by <b>Initialize</b> that is used to indicate hardware events or the completion of data block transfer operations.</li>
</ul>
<ul>
<li><b>PowerControl:</b> Controls the power profile of the peripheral and may be called after <b>Initialize</b>. Typically three power options are available:<ul>
<li>ARM_POWER_FULL: Peripheral is turned on and fully operational. The driver may initialize at that point the peripheral registers.</li>
<li>ARM_POWER_LOW: (optional) Peripheral is in low power mode and partially operational; usually it can detect external events and wake-up.</li>
<li>ARM_POWER_OFF: Peripheral is turned off and not operational (it will also stop any pending operations). This is also the state of the peripheral after device reset.</li>
</ul>
</li>
</ul>
<ul>
<li><b>Uninitialize:</b> Complementary function to Initialize. It will free all software resources used by the interface (de-allocate memory, release CMSIS-RTOS objects, ...).</li>
</ul>
<p>Additional functions are specific to each driver interface and described in the individual sections of each driver.</p>
<h1><a class="anchor" id="CallSequence"></a>
Function Call Sequence</h1>
<p>The driver API functions <b>GetVersion</b>, <b>GetCapabilities</b>, <b>Initialize</b>, <b>PowerControl</b>, <b>Uninitialize</b> are called in the following order:</p>
<div align="center">
<img src="msc_inline_mscgraph_3.png" alt="msc_inline_mscgraph_3" border="0" usemap="#msc_inline_mscgraph_3.map"/>
<map name="msc_inline_mscgraph_3.map" id="msc_inline_mscgraph_3.map"></map>
</div>
<hr/>
<h1><a class="anchor" id="History"></a>
Revision History</h1>
<table  class="cmtable" summary="Revision History">
<tr>
<th>Version </th><th>Description  </th></tr>
<tr>
<td>1.10 </td><td>Initial release  </td></tr>
</table>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Thu Feb 20 2014 15:15:58 for CMSIS Driver by ARM Ltd. All rights reserved.
	<!--
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.2 
	-->
	</li>
  </ul>
</div>
</body>
</html>
