<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Utility Routines</title>
<title>File System Component: Utility Routines</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="drv.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="stylsheetf" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 46px;">
  <td id="projectlogo"><img alt="Logo" src="keilarm.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">File System Component
   &#160;<span id="projectnumber">Version 5.0</span>
   </div>
   <div id="projectbrief">MDK-Professional Middleware for Devices with Flash File System</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<div id="DRVnav" class="tabs1">
    <ul class="tablist">
      <li id="GEN">   <a href="../../General/html/index.html"><span>General</span></a></li>
      <li id="FS"     class="current">    <a href="../../FileSystem/html/index.html"><span>File System</span></a></li>
      <li id="GRA">   <a href="../../Graphic/html/index.html"><span>Graphic</span></a></li>
      <li id="NET">   <a href="../../Network/html/index.html"><span>Network</span></a></li>
      <li id="USB">   <a href="../../USB/html/index.html"><span>USB</span></a></li>
    </ul>
</div>
<!-- Generated by Doxygen 1.8.2 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Usage&#160;and&#160;Description</span></a></li>
      <li><a href="modules.html"><span>Reference</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group__utility__routines.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Utility Routines</div>  </div>
</div><!--header-->
<div class="contents">

<p>Utility Routines provide analytical operations on drives.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gabfb453bab959866464dc7ec0f31ce7b9"><td class="memItemLeft" align="right" valign="top">int64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__utility__routines.html#gabfb453bab959866464dc7ec0f31ce7b9">ffree</a> (const char *drive)</td></tr>
<tr class="memdesc:gabfb453bab959866464dc7ec0f31ce7b9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find free space on drive.  <a href="#gabfb453bab959866464dc7ec0f31ce7b9"></a><br/></td></tr>
<tr class="separator:gabfb453bab959866464dc7ec0f31ce7b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaea20173a589e298b86791f1cc661731b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="rl__fs_8h.html#a326dc89f0e8665e419766e90c691b8d7">fsStatus</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__utility__routines.html#gaea20173a589e298b86791f1cc661731b">fformat</a> (const char *drive, const char *options)</td></tr>
<tr class="memdesc:gaea20173a589e298b86791f1cc661731b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Format drive.  <a href="#gaea20173a589e298b86791f1cc661731b"></a><br/></td></tr>
<tr class="separator:gaea20173a589e298b86791f1cc661731b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga660963ea80d7075eb5a80d075bd42cae"><td class="memItemLeft" align="right" valign="top">int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__utility__routines.html#ga660963ea80d7075eb5a80d075bd42cae">fanalyse</a> (const char *drive)</td></tr>
<tr class="memdesc:ga660963ea80d7075eb5a80d075bd42cae"><td class="mdescLeft">&#160;</td><td class="mdescRight">Analyse volume and check for file fragmentation.  <a href="#ga660963ea80d7075eb5a80d075bd42cae"></a><br/></td></tr>
<tr class="separator:ga660963ea80d7075eb5a80d075bd42cae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga363e98771d028aeda0bab22cb7b1bbfa"><td class="memItemLeft" align="right" valign="top"><a class="el" href="rl__fs_8h.html#a326dc89f0e8665e419766e90c691b8d7">fsStatus</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__utility__routines.html#ga363e98771d028aeda0bab22cb7b1bbfa">fcheck</a> (const char *drive)</td></tr>
<tr class="memdesc:ga363e98771d028aeda0bab22cb7b1bbfa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Analyse volume and check for allocation errors.  <a href="#ga363e98771d028aeda0bab22cb7b1bbfa"></a><br/></td></tr>
<tr class="separator:ga363e98771d028aeda0bab22cb7b1bbfa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga17ba4e8c1a25e721d583b29aaaee553f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="rl__fs_8h.html#a326dc89f0e8665e419766e90c691b8d7">fsStatus</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__utility__routines.html#ga17ba4e8c1a25e721d583b29aaaee553f">fdefrag</a> (const char *drive)</td></tr>
<tr class="memdesc:ga17ba4e8c1a25e721d583b29aaaee553f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Defragment Embedded Flash drive.  <a href="#ga17ba4e8c1a25e721d583b29aaaee553f"></a><br/></td></tr>
<tr class="separator:ga17ba4e8c1a25e721d583b29aaaee553f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad4670afc494105900a5069331b266606"><td class="memItemLeft" align="right" valign="top"><a class="el" href="rl__fs_8h.html#a326dc89f0e8665e419766e90c691b8d7">fsStatus</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__utility__routines.html#gad4670afc494105900a5069331b266606">fmedia</a> (const char *drive)</td></tr>
<tr class="memdesc:gad4670afc494105900a5069331b266606"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if media present on removable drive.  <a href="#gad4670afc494105900a5069331b266606"></a><br/></td></tr>
<tr class="separator:gad4670afc494105900a5069331b266606"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa8923f6394ef735392d95d966dca49cb"><td class="memItemLeft" align="right" valign="top"><a class="el" href="rl__fs_8h.html#a326dc89f0e8665e419766e90c691b8d7">fsStatus</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__utility__routines.html#gaa8923f6394ef735392d95d966dca49cb">finfo</a> (const char *drive, <a class="el" href="structfs_drive_info.html">fsDriveInfo</a> *info)</td></tr>
<tr class="memdesc:gaa8923f6394ef735392d95d966dca49cb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read drive information.  <a href="#gaa8923f6394ef735392d95d966dca49cb"></a><br/></td></tr>
<tr class="separator:gaa8923f6394ef735392d95d966dca49cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga78d23872719a6f8d82269622fd322fc3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="rl__fs_8h.html#a326dc89f0e8665e419766e90c691b8d7">fsStatus</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__utility__routines.html#ga78d23872719a6f8d82269622fd322fc3">fvol</a> (const char *drive, char *label, uint32_t *serial)</td></tr>
<tr class="memdesc:ga78d23872719a6f8d82269622fd322fc3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read volume label and serial number.  <a href="#ga78d23872719a6f8d82269622fd322fc3"></a><br/></td></tr>
<tr class="separator:ga78d23872719a6f8d82269622fd322fc3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Description</h2>
<p>You can analyse, format, and defragment drives. Also, reading drive and volume information data is supported. </p>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ga660963ea80d7075eb5a80d075bd42cae"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int32_t fanalyse </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>drive</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">drive</td><td>a string specifying the <a class="el" href="fs_operation.html#drive">memory or storage device</a>. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>fragmentation factor or execution status<ul>
<li>value &gt;= 0 or &lt;= 255: fragmentation factor</li>
<li>value &lt; 0: error occurred, -value is execution status as defined with <a class="el" href="group__status__error__codes__fs.html#ga326dc89f0e8665e419766e90c691b8d7">fsStatus</a> </li>
</ul>
</dd></dl>
<dl class="section note"><dt>Note</dt><dd>This function supports EFS drives only.</dd></dl>
<p>The function <b>fanalyse</b> examines the Embedded File System and checks for file fragmentation.</p>
<p>The argument <em>drive</em> may only use NOR and SPI <a class="el" href="fs_operation.html#drive">drives</a>, as well as "" (<a class="el" href="fs_operation.html#def_sys_drive">Default System Drive</a>).</p>
<p><b>Code Example</b> </p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> free_space (<span class="keywordtype">void</span>) {</div>
<div class="line"></div>
<div class="line">  printf (<span class="stringliteral">&quot;\nFree space before defrag: %d bytes.&quot;</span>, <a class="code" href="group__utility__routines.html#gabfb453bab959866464dc7ec0f31ce7b9" title="Find free space on drive.">ffree</a>(<span class="stringliteral">&quot;&quot;</span>));</div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code" href="group__utility__routines.html#ga660963ea80d7075eb5a80d075bd42cae" title="Analyse volume and check for file fragmentation.">fanalyse</a>(<span class="stringliteral">&quot;&quot;</span>) &gt; 50) {</div>
<div class="line">    <a class="code" href="group__utility__routines.html#ga17ba4e8c1a25e721d583b29aaaee553f" title="Defragment Embedded Flash drive.">fdefrag</a> (<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line">  }</div>
<div class="line">  printf (<span class="stringliteral">&quot;\nFree space after defrag: %d bytes.&quot;</span>, <a class="code" href="group__utility__routines.html#gabfb453bab959866464dc7ec0f31ce7b9" title="Find free space on drive.">ffree</a>(<span class="stringliteral">&quot;&quot;</span>));</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
</div>
<a class="anchor" id="ga363e98771d028aeda0bab22cb7b1bbfa"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="rl__fs_8h.html#a326dc89f0e8665e419766e90c691b8d7">fsStatus</a> fcheck </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>drive</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">drive</td><td>a string specifying the <a class="el" href="fs_operation.html#drive">memory or storage device</a>. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>execution status <a class="el" href="group__status__error__codes__fs.html#ga326dc89f0e8665e419766e90c691b8d7">fsStatus</a><ul>
<li>fsOK = Operation successful, no allocation errors</li>
<li>fsInvalidDrive = Nonexistent drive letter specified.</li>
<li>fsAccessDenied = Unsupported drive.</li>
<li>fsTooManyOpenFiles = File cannot be opened due to too many opened files.</li>
<li>fsError = Check failed due to allocation errors. </li>
</ul>
</dd></dl>
<dl class="section note"><dt>Note</dt><dd>This function supports EFS drives only.</dd></dl>
<p>The function <b>fcheck</b> analyses the consistency of the Embedded File System and determines if it has been initialized.</p>
<p>The argument <em>drive</em> may only use NOR and SPI <a class="el" href="fs_operation.html#drive">drives</a>, as well as "" (<a class="el" href="fs_operation.html#def_sys_drive">Default System Drive</a>).</p>
<p><b>Code Example</b> </p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> tst_files (<span class="keywordtype">void</span>) {</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code" href="group__utility__routines.html#ga363e98771d028aeda0bab22cb7b1bbfa" title="Analyse volume and check for allocation errors.">fcheck</a> (<span class="stringliteral">&quot;R:&quot;</span>) != <a class="code" href="group__status__error__codes__fs.html#gga326dc89f0e8665e419766e90c691b8d7a4456550a7764bbc4805e75946bd5a4c8" title="Operation succeeded.">fsOK</a>) {</div>
<div class="line">    printf (<span class="stringliteral">&quot;Flash File System inconsistent, formatting...\n&quot;</span>);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code" href="group__utility__routines.html#gaea20173a589e298b86791f1cc661731b" title="Format drive.">fformat</a> (<span class="stringliteral">&quot;R:&quot;</span>) != <a class="code" href="group__status__error__codes__fs.html#gga326dc89f0e8665e419766e90c691b8d7a4456550a7764bbc4805e75946bd5a4c8" title="Operation succeeded.">fsOK</a>) {</div>
<div class="line">      printf (<span class="stringliteral">&quot;Formatting failed.\n&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span> {</div>
<div class="line">      printf (<span class="stringliteral">&quot;Format done.\n&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
</div>
<a class="anchor" id="ga17ba4e8c1a25e721d583b29aaaee553f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="rl__fs_8h.html#a326dc89f0e8665e419766e90c691b8d7">fsStatus</a> fdefrag </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>drive</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">drive</td><td>a string specifying the <a class="el" href="fs_operation.html#drive">memory or storage device</a>. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>execution status <a class="el" href="group__status__error__codes__fs.html#ga326dc89f0e8665e419766e90c691b8d7">fsStatus</a><ul>
<li>fsOK = Operation successful.</li>
<li>fsInvalidDrive = Nonexistent drive letter specified.</li>
<li>fsAccessDenied = Not all files are closed on specified drive or unsupported drive.</li>
<li>fsTooManyOpenFiles = File cannot be opened due to too many opened files.</li>
<li>fsNoFreeSpace = Not enough space to complete the defragmentation. </li>
</ul>
</dd></dl>
<dl class="section note"><dt>Note</dt><dd>This function supports EFS drives only.</dd></dl>
<p>The function <b>fdefrag</b> defragments the Embedded File System.</p>
<p>The argument <em>drive</em> may only use NOR and SPI <a class="el" href="fs_operation.html#drive">drives</a>, as well as "" (<a class="el" href="fs_operation.html#def_sys_drive">Default System Drive</a>).</p>
<p><b>Code Example</b> </p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> free_space (<span class="keywordtype">void</span>)  {</div>
<div class="line"></div>
<div class="line">  printf (<span class="stringliteral">&quot;\nFree space before defrag: %d bytes.&quot;</span>, <a class="code" href="group__utility__routines.html#gabfb453bab959866464dc7ec0f31ce7b9" title="Find free space on drive.">ffree</a>(<span class="stringliteral">&quot;F:&quot;</span>));</div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code" href="group__utility__routines.html#ga660963ea80d7075eb5a80d075bd42cae" title="Analyse volume and check for file fragmentation.">fanalyse</a>(<span class="stringliteral">&quot;F:&quot;</span>) &gt; 50) {</div>
<div class="line">     <a class="code" href="group__utility__routines.html#ga17ba4e8c1a25e721d583b29aaaee553f" title="Defragment Embedded Flash drive.">fdefrag</a> (<span class="stringliteral">&quot;F:&quot;</span>);</div>
<div class="line">  }</div>
<div class="line">  printf (<span class="stringliteral">&quot;\nFree space after defrag: %d bytes.&quot;</span>, <a class="code" href="group__utility__routines.html#gabfb453bab959866464dc7ec0f31ce7b9" title="Find free space on drive.">ffree</a>(<span class="stringliteral">&quot;F:&quot;</span>));</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
</div>
<a class="anchor" id="gaea20173a589e298b86791f1cc661731b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="rl__fs_8h.html#a326dc89f0e8665e419766e90c691b8d7">fsStatus</a> fformat </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>drive</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">drive</td><td>a string specifying the <a class="el" href="fs_operation.html#drive">memory or storage device</a>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">options</td><td>string specifying formatting options. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>execution status <a class="el" href="group__status__error__codes__fs.html#ga326dc89f0e8665e419766e90c691b8d7">fsStatus</a><ul>
<li>fsOK = Operation successful.</li>
<li>fsInvalidDrive = Nonexistent drive letter specified.</li>
<li>fsTooManyOpenFiles = File cannot be opened due to too many opened files.</li>
<li>fsError = Formatting failed.</li>
</ul>
</dd></dl>
<p>The function <b>fformat</b> formats an EFS or FAT storage media for using a file system. The function closes all open files on the specified <em>drive</em>. Existing file handles become invalid.</p>
<p>The argument <em>drive</em> is specifying the <a class="el" href="fs_operation.html#drive">drive</a>. In addition, you may also use "" (<a class="el" href="fs_operation.html#def_sys_drive">Default System Drive</a>).</p>
<p>The argument <em>options</em> can be NULL when formatting options are not used or a pointer to a string specifying following options: </p>
<table class="doxtable">
<tr>
<th>Option </th><th>Description </th></tr>
<tr>
<td>/L label </td><td>Specifies volume label for a FAT drive. If /L option is not specified or if label is not given, then volume label will not be written. </td></tr>
<tr>
<td>/FAT32 </td><td>Formats the media for using the FAT32 file system. </td></tr>
<tr>
<td>/W </td><td>Clears all data. Erases all available data sectors. </td></tr>
<tr>
<td>/LL </td><td>Clears all data. Performs low-level formatting first. </td></tr>
<tr>
<td>/LLEB </td><td>Clears all data. Performs low-level formatting and erases bad blocks first. </td></tr>
</table>
<p><b>Code Example</b> </p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> format_drive (<span class="keywordtype">void</span>) {</div>
<div class="line">  <span class="keywordtype">char</span> *opt;</div>
<div class="line">  <span class="comment">// Set formatting options</span></div>
<div class="line">  opt = <span class="stringliteral">&quot;/L SD Card /FAT32&quot;</span>;</div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code" href="group__utility__routines.html#gaea20173a589e298b86791f1cc661731b" title="Format drive.">fformat</a> (<span class="stringliteral">&quot;M:&quot;</span>, opt) != <a class="code" href="group__status__error__codes__fs.html#gga326dc89f0e8665e419766e90c691b8d7a4456550a7764bbc4805e75946bd5a4c8" title="Operation succeeded.">fsOK</a>) {</div>
<div class="line">    printf (<span class="stringliteral">&quot;Formatting failed!\n&quot;</span>);</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">else</span> {</div>
<div class="line">    printf (<span class="stringliteral">&quot;Drive formatted using FAT 32 with label SD Card.\n&quot;</span>);</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
</div>
<a class="anchor" id="gabfb453bab959866464dc7ec0f31ce7b9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int64_t ffree </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>drive</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">drive</td><td>a string specifying the <a class="el" href="fs_operation.html#drive">memory or storage device</a>. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>free space or execution status<ul>
<li>value &gt;= 0: free space on drive in bytes.</li>
<li>value &lt; 0: error occurred, -value is execution status as defined with <a class="el" href="group__status__error__codes__fs.html#ga326dc89f0e8665e419766e90c691b8d7">fsStatus</a></li>
</ul>
</dd></dl>
<p>The function <b>ffree</b> calculates the free space on a device.</p>
<p>The argument <em>drive</em> is specifying a <a class="el" href="fs_operation.html#drive">drive</a>.</p>
<p><b>Code Example</b> </p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> free_space (<span class="keywordtype">void</span>)  {</div>
<div class="line">  printf (<span class="stringliteral">&quot;Flash Drive free: %lld bytes.\n&quot;</span>, <a class="code" href="group__utility__routines.html#gabfb453bab959866464dc7ec0f31ce7b9" title="Find free space on drive.">ffree</a>(<span class="stringliteral">&quot;F:&quot;</span>));</div>
<div class="line">  printf (<span class="stringliteral">&quot;Ram Drive free: %lld bytes.\n&quot;</span>, <a class="code" href="group__utility__routines.html#gabfb453bab959866464dc7ec0f31ce7b9" title="Find free space on drive.">ffree</a>(<span class="stringliteral">&quot;R:&quot;</span>));</div>
<div class="line">  printf (<span class="stringliteral">&quot;SD Card Drive 1 free: %lld bytes.\n&quot;</span>, <a class="code" href="group__utility__routines.html#gabfb453bab959866464dc7ec0f31ce7b9" title="Find free space on drive.">ffree</a>(<span class="stringliteral">&quot;M0:&quot;</span>));</div>
<div class="line">  printf (<span class="stringliteral">&quot;SD Card Drive 2 free: %lld bytes.\n&quot;</span>, <a class="code" href="group__utility__routines.html#gabfb453bab959866464dc7ec0f31ce7b9" title="Find free space on drive.">ffree</a>(<span class="stringliteral">&quot;M1:&quot;</span>));</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
</div>
<a class="anchor" id="gaa8923f6394ef735392d95d966dca49cb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="rl__fs_8h.html#a326dc89f0e8665e419766e90c691b8d7">fsStatus</a> finfo </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>drive</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structfs_drive_info.html">fsDriveInfo</a> *&#160;</td>
          <td class="paramname"><em>info</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">drive</td><td>a string specifying the <a class="el" href="fs_operation.html#drive">memory or storage device</a>. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">info</td><td>drive information structure. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>execution status <a class="el" href="group__status__error__codes__fs.html#ga326dc89f0e8665e419766e90c691b8d7">fsStatus</a><ul>
<li>fsOK = Operation successful.</li>
<li>fsInvalidParameter = Input parameters invalid.</li>
<li>fsInvalidDrive = Nonexistent drive letter specified.</li>
</ul>
</dd></dl>
<p>The function <b>finfo</b> reads general drive informations from the volume and puts them into the <em>info</em> structure.</p>
<p>The argument <em>drive</em> is specifying a FAT volume <a class="el" href="fs_operation.html#drive">drive</a>. The <a class="el" href="fs_operation.html#def_sys_drive">Default System Drive</a> is used, if an empty string "" is provided. </p>

</div>
</div>
<a class="anchor" id="gad4670afc494105900a5069331b266606"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="rl__fs_8h.html#a326dc89f0e8665e419766e90c691b8d7">fsStatus</a> fmedia </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>drive</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">drive</td><td>a string specifying the <a class="el" href="fs_operation.html#drive">memory or storage device</a>. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>execution status <a class="el" href="group__status__error__codes__fs.html#ga326dc89f0e8665e419766e90c691b8d7">fsStatus</a><ul>
<li>fsOK = Operation successful.</li>
<li>fsNoMedia = Media not present.</li>
<li>fsAccessDenied = Tried to access non-removable drive. </li>
</ul>
</dd></dl>
<dl class="section note"><dt>Note</dt><dd>This function supports FAT drives only.</dd></dl>
<p>The function <b>fmedia</b> checks the presence of a removable drive in the system (such as SD/MMC cards or USB Flash drives). If a media device interface driver is not able to detect the presence of the associated media this function always returns fsOK.</p>
<p>The argument <em>drive</em> may only use Memory Card and USB Flash <a class="el" href="fs_operation.html#drive">drives</a>, as well as "" (for using the <a class="el" href="fs_operation.html#def_sys_drive">Default System Drive</a>). </p>

</div>
</div>
<a class="anchor" id="ga78d23872719a6f8d82269622fd322fc3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="rl__fs_8h.html#a326dc89f0e8665e419766e90c691b8d7">fsStatus</a> fvol </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>drive</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>label</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t *&#160;</td>
          <td class="paramname"><em>serial</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">drive</td><td>a string specifying the <a class="el" href="fs_operation.html#drive">memory or storage device</a>. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">label</td><td>buffer for storing label as a null terminated string. When volume has no label an empty string is returned. This parameter can be NULL meaning label will not be read. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">serial</td><td>pointer to variable where serial number will be stored. This parameter can be NULL meaning serial number will not be read. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>execution status <a class="el" href="group__status__error__codes__fs.html#ga326dc89f0e8665e419766e90c691b8d7">fsStatus</a><ul>
<li>fsOK = Operation successful.</li>
<li>fsInvalidDrive = Nonexistent drive letter specified.</li>
<li>fsAccessDenied = Trying to read label and serial from EFS drive.</li>
<li>fsDriverError = Read/write error. </li>
</ul>
</dd></dl>
<dl class="section note"><dt>Note</dt><dd>This function supports FAT drives only.</dd></dl>
<p>The function <b>fvol</b> reads the volume label.</p>
<p>The argument <em>drive</em> is specifying a FAT volume <a class="el" href="fs_operation.html#drive">drive</a>. The <a class="el" href="fs_operation.html#def_sys_drive">Default System Drive</a> is used, if an empty string "" is provided.</p>
<p>The argument <em>label</em> specifies a buffer where the volume label will be stored as a null terminated string. Its size must be at least 12 bytes to prevent buffer overflow. If volume has no label an empty string is returned.</p>
<p>The argument <em>serial</em> specifies a pointer to a 32-bit variable where the volume serial number will be stored. The serial number is usually written when the volume is formatted and can be used to distinguish between volumes on removable devices.</p>
<p><b>Code Example</b> </p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> tst_fvol (<span class="keywordtype">void</span>) {</div>
<div class="line">  <span class="keywordtype">char</span> label[12];</div>
<div class="line">  uint32_t ser_num;</div>
<div class="line">  </div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code" href="group__utility__routines.html#ga78d23872719a6f8d82269622fd322fc3" title="Read volume label and serial number.">fvol</a>(<span class="stringliteral">&quot;U0:&quot;</span>, label, &amp;ser_num) == <a class="code" href="group__status__error__codes__fs.html#gga326dc89f0e8665e419766e90c691b8d7a4456550a7764bbc4805e75946bd5a4c8" title="Operation succeeded.">fsOK</a>) {</div>
<div class="line">    <span class="keywordflow">if</span> (label_buf[0]) {</div>
<div class="line">      printf (<span class="stringliteral">&quot;Volume in drive U0 is %s\n&quot;</span>, label);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span> {</div>
<div class="line">      printf (<span class="stringliteral">&quot;Volume in drive U0 has no label.\n&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">    printf (<span class="stringliteral">&quot;Volume serial number is %x\n&quot;</span>, ser_num);</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">else</span> {</div>
<div class="line">    printf (<span class="stringliteral">&quot;Volume access error!\n&quot;</span>);</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Thu Feb 20 2014 15:12:35 for File System Component by ARM Ltd. All rights reserved.
	<!--
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.2 
	-->
	</li>
  </ul>
</div>
</body>
</html>
