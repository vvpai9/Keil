<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>BSD Socket</title>
<title>Network Component: BSD Socket</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="drv.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="stylsheetf" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 46px;">
  <td id="projectlogo"><img alt="Logo" src="keilarm.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">Network Component
   &#160;<span id="projectnumber">Version 5.0</span>
   </div>
   <div id="projectbrief">MDK-Professional Middleware for IP Networking</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<div id="DRVnav" class="tabs1">
    <ul class="tablist">
      <li id="GEN">	  <a href="../../General/html/index.html"><span>General</span></a></li>
      <li id="FS">    <a href="../../FileSystem/html/index.html"><span>File System</span></a></li>
      <li id="GRA">   <a href="../../Graphic/html/index.html"><span>Graphic</span></a></li>
      <li id="NET"    class="current">  <a href="../../Network/html/index.html"><span>Network</span></a></li>
      <li id="USB">   <a href="../../USB/html/index.html"><span>USB</span></a></li>
    </ul>
</div>
<!-- Generated by Doxygen 1.8.2 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Usage&#160;and&#160;Description</span></a></li>
      <li><a href="modules.html"><span>Reference</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group__bsd__routines.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Structures</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">BSD Socket</div>  </div>
<div class="ingroups"><a class="el" href="group__net__sockets.html">Sockets</a></div></div><!--header-->
<div class="contents">

<p>BSD socket routines enable BSD compliant communication over TCP/IP.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Structures</h2></td></tr>
<tr class="memitem:struct_s_o_c_k_a_d_d_r"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__bsd__routines.html#struct_s_o_c_k_a_d_d_r">SOCKADDR</a></td></tr>
<tr class="memdesc:struct_s_o_c_k_a_d_d_r"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generic Socket Address structure.  <a href="group__bsd__routines.html#struct_s_o_c_k_a_d_d_r">More...</a><br/></td></tr>
<tr class="separator:struct_s_o_c_k_a_d_d_r"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gabd21dff339393ec8e83b439d1120df71"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__bsd__routines.html#gabd21dff339393ec8e83b439d1120df71">socket</a> (int family, int type, int protocol)</td></tr>
<tr class="memdesc:gabd21dff339393ec8e83b439d1120df71"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a communication endpoint called socket.  <a href="#gabd21dff339393ec8e83b439d1120df71"></a><br/></td></tr>
<tr class="separator:gabd21dff339393ec8e83b439d1120df71"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga03a7134a282d45095ea30edb8e1cd076"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__bsd__routines.html#ga03a7134a282d45095ea30edb8e1cd076">bind</a> (int sock, const <a class="el" href="group__bsd__routines.html#struct_s_o_c_k_a_d_d_r">SOCKADDR</a> *addr, int addrlen)</td></tr>
<tr class="memdesc:ga03a7134a282d45095ea30edb8e1cd076"><td class="mdescLeft">&#160;</td><td class="mdescRight">Assign a local address and port to a socket.  <a href="#ga03a7134a282d45095ea30edb8e1cd076"></a><br/></td></tr>
<tr class="separator:ga03a7134a282d45095ea30edb8e1cd076"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7005ffbeeff92be5394ff3244da79028"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__bsd__routines.html#ga7005ffbeeff92be5394ff3244da79028">listen</a> (int sock, int backlog)</td></tr>
<tr class="memdesc:ga7005ffbeeff92be5394ff3244da79028"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set a socket in a listening mode.  <a href="#ga7005ffbeeff92be5394ff3244da79028"></a><br/></td></tr>
<tr class="separator:ga7005ffbeeff92be5394ff3244da79028"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga18e88467cfdbc3c361d53b9f928a87ab"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__bsd__routines.html#ga18e88467cfdbc3c361d53b9f928a87ab">accept</a> (int sock, <a class="el" href="group__bsd__routines.html#struct_s_o_c_k_a_d_d_r">SOCKADDR</a> *addr, int *addrlen)</td></tr>
<tr class="memdesc:ga18e88467cfdbc3c361d53b9f928a87ab"><td class="mdescLeft">&#160;</td><td class="mdescRight">Accept connect request for a listening socket.  <a href="#ga18e88467cfdbc3c361d53b9f928a87ab"></a><br/></td></tr>
<tr class="separator:ga18e88467cfdbc3c361d53b9f928a87ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gadced863676ed93d1334ba8abef937dd1"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__bsd__routines.html#gadced863676ed93d1334ba8abef937dd1">connect</a> (int sock, <a class="el" href="group__bsd__routines.html#struct_s_o_c_k_a_d_d_r">SOCKADDR</a> *addr, int addrlen)</td></tr>
<tr class="memdesc:gadced863676ed93d1334ba8abef937dd1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Connect a socket to a remote host.  <a href="#gadced863676ed93d1334ba8abef937dd1"></a><br/></td></tr>
<tr class="separator:gadced863676ed93d1334ba8abef937dd1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga27f7859e634a2cd0ab98219b5092f7f7"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__bsd__routines.html#ga27f7859e634a2cd0ab98219b5092f7f7">send</a> (int sock, const char *buf, int len, int flags)</td></tr>
<tr class="memdesc:ga27f7859e634a2cd0ab98219b5092f7f7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Send data on already connected socket.  <a href="#ga27f7859e634a2cd0ab98219b5092f7f7"></a><br/></td></tr>
<tr class="separator:ga27f7859e634a2cd0ab98219b5092f7f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac238092843e59c729b6904b18eeeff77"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__bsd__routines.html#gac238092843e59c729b6904b18eeeff77">sendto</a> (int sock, const char *buf, int len, int flags, <a class="el" href="group__bsd__routines.html#struct_s_o_c_k_a_d_d_r">SOCKADDR</a> *to, int tolen)</td></tr>
<tr class="memdesc:gac238092843e59c729b6904b18eeeff77"><td class="mdescLeft">&#160;</td><td class="mdescRight">Send data to endpoint node.  <a href="#gac238092843e59c729b6904b18eeeff77"></a><br/></td></tr>
<tr class="separator:gac238092843e59c729b6904b18eeeff77"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae13b0fcffdc4f2c181a1def0b641ead4"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__bsd__routines.html#gae13b0fcffdc4f2c181a1def0b641ead4">recv</a> (int sock, char *buf, int len, int flags)</td></tr>
<tr class="memdesc:gae13b0fcffdc4f2c181a1def0b641ead4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Receive data on already connected socket.  <a href="#gae13b0fcffdc4f2c181a1def0b641ead4"></a><br/></td></tr>
<tr class="separator:gae13b0fcffdc4f2c181a1def0b641ead4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac6b00a29e8f1664d7ba4a70bfb92d9db"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__bsd__routines.html#gac6b00a29e8f1664d7ba4a70bfb92d9db">recvfrom</a> (int sock, char *buf, int len, int flags, <a class="el" href="group__bsd__routines.html#struct_s_o_c_k_a_d_d_r">SOCKADDR</a> *from, int *fromlen)</td></tr>
<tr class="memdesc:gac6b00a29e8f1664d7ba4a70bfb92d9db"><td class="mdescLeft">&#160;</td><td class="mdescRight">Receive data from endpoint node.  <a href="#gac6b00a29e8f1664d7ba4a70bfb92d9db"></a><br/></td></tr>
<tr class="separator:gac6b00a29e8f1664d7ba4a70bfb92d9db"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad272c8891ecce101c35bf18e3dc03d38"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__bsd__routines.html#gad272c8891ecce101c35bf18e3dc03d38">closesocket</a> (int sock)</td></tr>
<tr class="memdesc:gad272c8891ecce101c35bf18e3dc03d38"><td class="mdescLeft">&#160;</td><td class="mdescRight">Close socket and release socket descriptor.  <a href="#gad272c8891ecce101c35bf18e3dc03d38"></a><br/></td></tr>
<tr class="separator:gad272c8891ecce101c35bf18e3dc03d38"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9c2820e49f50f3757136f8bd928ab279"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__bsd__routines.html#ga9c2820e49f50f3757136f8bd928ab279">getpeername</a> (int sock, <a class="el" href="group__bsd__routines.html#struct_s_o_c_k_a_d_d_r">SOCKADDR</a> *name, int *namelen)</td></tr>
<tr class="memdesc:ga9c2820e49f50f3757136f8bd928ab279"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieve IP address and port number of the endpoint node.  <a href="#ga9c2820e49f50f3757136f8bd928ab279"></a><br/></td></tr>
<tr class="separator:ga9c2820e49f50f3757136f8bd928ab279"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaccbeb567d8c775d4405dc556433bb592"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__bsd__routines.html#gaccbeb567d8c775d4405dc556433bb592">getsockname</a> (int sock, <a class="el" href="group__bsd__routines.html#struct_s_o_c_k_a_d_d_r">SOCKADDR</a> *name, int *namelen)</td></tr>
<tr class="memdesc:gaccbeb567d8c775d4405dc556433bb592"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieve local IP address and port number.  <a href="#gaccbeb567d8c775d4405dc556433bb592"></a><br/></td></tr>
<tr class="separator:gaccbeb567d8c775d4405dc556433bb592"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0b42eb9e32b55aff7130ef48afd8b885"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__bsd__routines.html#ga0b42eb9e32b55aff7130ef48afd8b885">ioctlsocket</a> (int sock, long cmd, unsigned long *argp)</td></tr>
<tr class="memdesc:ga0b42eb9e32b55aff7130ef48afd8b885"><td class="mdescLeft">&#160;</td><td class="mdescRight">Control IO mode of a socket.  <a href="#ga0b42eb9e32b55aff7130ef48afd8b885"></a><br/></td></tr>
<tr class="separator:ga0b42eb9e32b55aff7130ef48afd8b885"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad5213a5aefe3d46dc5aa0c5813c06b1d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="rl__net_8h.html#struct_h_o_s_t_e_n_t">HOSTENT</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__bsd__routines.html#gad5213a5aefe3d46dc5aa0c5813c06b1d">gethostbyname</a> (const char *name, int *err)</td></tr>
<tr class="memdesc:gad5213a5aefe3d46dc5aa0c5813c06b1d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieve host IP address from host name.  <a href="#gad5213a5aefe3d46dc5aa0c5813c06b1d"></a><br/></td></tr>
<tr class="separator:gad5213a5aefe3d46dc5aa0c5813c06b1d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Description</h2>
<p>BSD socket routines enable BSD compliant communication over TCP/IP. </p>
<p>The BSD sockets application programming interface (API) is a set of standard function calls that can be used in an application. They allow programmers to add Internet communication to their products.</p>
<p>BSD sockets is not a stand-alone socket solution, but it is an API that relies on other socket communication for data exchange. Thus, you always need to add <a class="el" href="group__tcp__routines.html">TCP</a> and <a class="el" href="group__udp__routines.html">UDP</a> to your project if you wish to use BSD sockets.</p>
<dl class="section note"><dt>Note</dt><dd>More information on the usage of BSD and how to work with the functions is available at <a class="el" href="using_network_sockets_bsd.html">BSD Socket</a>. </dd></dl>
<hr/><h2 class="groupheader">Data Structure Documentation</h2>
<a name="struct_s_o_c_k_a_d_d_r" id="struct_s_o_c_k_a_d_d_r"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct SOCKADDR</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock"><p>Generic Socket Address structure. </p>
<p><b>Parameter for:</b></p>
<ul>
<li><a class="el" href="group__bsd__routines.html#ga18e88467cfdbc3c361d53b9f928a87ab">accept</a>, <a class="el" href="group__bsd__routines.html#ga03a7134a282d45095ea30edb8e1cd076">bind</a>, <a class="el" href="group__bsd__routines.html#gadced863676ed93d1334ba8abef937dd1">connect</a>, <a class="el" href="group__bsd__routines.html#ga9c2820e49f50f3757136f8bd928ab279">getpeername</a>, <a class="el" href="group__bsd__routines.html#gaccbeb567d8c775d4405dc556433bb592">getsockname</a>, <a class="el" href="group__bsd__routines.html#gac6b00a29e8f1664d7ba4a70bfb92d9db">recvfrom</a>, <a class="el" href="group__bsd__routines.html#gac238092843e59c729b6904b18eeeff77">sendto</a> </li>
</ul>
</div><table class="fieldtable">
<tr><th colspan="3">Data Fields</th></tr>
<tr><td class="fieldtype">
<a class="anchor" id="afb9b9db15b48e767b573187b4d911c90"></a>int8_t</td>
<td class="fieldname">
sa_data</td>
<td class="fielddoc">
Direct address (up to 14 bytes) </td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="a4df9597bca2a0bd5d0f51e93f3b762e7"></a>uint16_t</td>
<td class="fieldname">
sa_family</td>
<td class="fielddoc">
Address family. </td></tr>
</table>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ga18e88467cfdbc3c361d53b9f928a87ab"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int accept </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>sock</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__bsd__routines.html#struct_s_o_c_k_a_d_d_r">SOCKADDR</a> *&#160;</td>
          <td class="paramname"><em>addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>addrlen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Accept connect request for a listening socket. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">sock</td><td>socket descriptor obtained with <a class="el" href="group__bsd__routines.html#gabd21dff339393ec8e83b439d1120df71">socket</a>. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">addr</td><td>structure that will receive IP address and port number, or NULL for none </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">addrlen</td><td>length of <a class="el" href="group__bsd__routines.html#struct_s_o_c_k_a_d_d_r">SOCKADDR</a> structure. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>status information:<ul>
<li>Socket descriptor identification number or</li>
<li>BSD_ERROR_SOCKET = Socket invalid.</li>
<li>BSD_ERROR_WOULDBLOCK = Function would block in non-blocking mode.</li>
<li>BSD_ERROR_CLOSED = Remote node has closed the connection.</li>
</ul>
</dd></dl>
<p>The function <b>accept</b> accepts a connection request queued for a listening socket. If a connection request is pending, <b>accept</b> removes the request from the queue, and a new socket is created for the connection. The original listening socket remains open and continues to queue new connection requests. The socket <em>sock</em> must be a <b>SOCK_STREAM</b> type socket.</p>
<p>In blocking mode, which is enabled if the system detects RTX environment, this functions waits for a connection request. In non blocking mode, you must call the <b>accept</b> function again if the error code BSD_ERROR_WOULDBLOCK is returned.</p>
<p>The argument <em>sock</em> specifies a socket descriptor returned from a previous call to <a class="el" href="group__bsd__routines.html#gabd21dff339393ec8e83b439d1120df71">socket</a>.</p>
<p>The argument <em>addr</em> is a pointer to the <a class="el" href="group__bsd__routines.html#struct_s_o_c_k_a_d_d_r" title="Generic Socket Address structure.">SOCKADDR</a> structure that will receive the connection node IP address and port number.</p>
<p>The argument <em>addrlen</em> is a pointer to the address length. It should initially contain the amount of space pointed to by <em>addr</em>. On return it contains the actual length of the address returned in bytes.</p>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>You must call the <a class="el" href="group__bsd__routines.html#gabd21dff339393ec8e83b439d1120df71">socket</a> function before any other function calls to the BSD socket.</li>
<li>If a negative number is returned, it represents an error code.</li>
</ul>
</dd></dl>
<p><b>Code Example</b> </p>
<div class="fragment"><div class="line"><span class="comment">//----------------------------------------------------------------------------</span></div>
<div class="line"><span class="comment">//  Thread &#39;Server&#39;: BSD Server socket process</span></div>
<div class="line"><span class="comment">//----------------------------------------------------------------------------</span></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> Server (<span class="keywordtype">void</span> <span class="keyword">const</span> *arg) {</div>
<div class="line">  <a class="code" href="rl__net_8h.html#struct_s_o_c_k_a_d_d_r___i_n" title="IPv4 Socket Address structure.">SOCKADDR_IN</a> addr;</div>
<div class="line">  <span class="keywordtype">int</span> sock, sd, res;</div>
<div class="line">  <span class="keywordtype">int</span> type = (int)arg;</div>
<div class="line">  <span class="keywordtype">char</span> dbuf[4];</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">while</span> (1) {</div>
<div class="line">    sock = <a class="code" href="group__bsd__routines.html#gabd21dff339393ec8e83b439d1120df71" title="Create a communication endpoint called socket.">socket</a> (<a class="code" href="rl__net_8h.html#a9930604d0e32588eae76f43ca38e7826" title="Internet Address Family (UDP, TCP)">AF_INET</a>, type, 0);</div>
<div class="line"></div>
<div class="line">    addr.<a class="code" href="rl__net_8h.html#a17c017619a9612c083063a3438ac4b5e" title="Port.">sin_port</a>        = <a class="code" href="rl__net_8h.html#af3a256b18d0645af51564e63fec1bbbb">htons</a>(PORT_NUM);</div>
<div class="line">    addr.<a class="code" href="rl__net_8h.html#a321ed882a4b4cd66d1b9ad64ababd67e" title="Socket domain.">sin_family</a>      = <a class="code" href="rl__net_8h.html#a3f5da0b5be27fe31ec7cc11bfa8d1a25" title="Internet Address Family (UDP, TCP)">PF_INET</a>;</div>
<div class="line">    addr.<a class="code" href="rl__net_8h.html#a92b552b33b68a46c97a8d27a13a8bfb6" title="IP address.">sin_addr</a>.s_addr = <a class="code" href="rl__net_8h.html#a5d1940045dc2e7de552f3d4ff13a74ab" title="BSD Internet Addresses.">INADDR_ANY</a>;</div>
<div class="line"></div>
<div class="line">    <a class="code" href="group__bsd__routines.html#ga03a7134a282d45095ea30edb8e1cd076" title="Assign a local address and port to a socket.">bind</a> (sock, (<a class="code" href="group__bsd__routines.html#struct_s_o_c_k_a_d_d_r" title="Generic Socket Address structure.">SOCKADDR</a> *)&amp;addr, <span class="keyword">sizeof</span>(addr));</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (type == <a class="code" href="rl__net_8h.html#a249394484f9410a2e3f8eba24657feb9" title="BSD Socket Type.">SOCK_STREAM</a>) {</div>
<div class="line">      <a class="code" href="group__bsd__routines.html#ga7005ffbeeff92be5394ff3244da79028" title="Set a socket in a listening mode.">listen</a> (sock, 1);</div>
<div class="line">      sd = <a class="code" href="group__bsd__routines.html#ga18e88467cfdbc3c361d53b9f928a87ab" title="Accept connect request for a listening socket.">accept</a> (sock, NULL, NULL);</div>
<div class="line">      <a class="code" href="group__bsd__routines.html#gad272c8891ecce101c35bf18e3dc03d38" title="Close socket and release socket descriptor.">closesocket</a> (sock);</div>
<div class="line">      sock = sd;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">while</span> (1) {</div>
<div class="line">      res = <a class="code" href="group__bsd__routines.html#gae13b0fcffdc4f2c181a1def0b641ead4" title="Receive data on already connected socket.">recv</a> (sock, dbuf, <span class="keyword">sizeof</span> (dbuf), 0);</div>
<div class="line">      <span class="keywordflow">if</span> (res &lt;= 0) {</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">      }</div>
<div class="line">      <span class="keywordflow">if</span> (dbuf[0] == BLINKLED) {</div>
<div class="line">        LED_Out (dbuf[1]);</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">    <a class="code" href="group__bsd__routines.html#gad272c8891ecce101c35bf18e3dc03d38" title="Close socket and release socket descriptor.">closesocket</a> (sock);</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
</div>
<a class="anchor" id="ga03a7134a282d45095ea30edb8e1cd076"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int bind </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>sock</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="group__bsd__routines.html#struct_s_o_c_k_a_d_d_r">SOCKADDR</a> *&#160;</td>
          <td class="paramname"><em>addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>addrlen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Assign a local address and port to a socket. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">sock</td><td>socket descriptor obtained with <a class="el" href="group__bsd__routines.html#gabd21dff339393ec8e83b439d1120df71">socket</a>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">addr</td><td>structure containing local IP address and port. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">addrlen</td><td>length of <a class="el" href="group__bsd__routines.html#struct_s_o_c_k_a_d_d_r">SOCKADDR</a> structure. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>status information:<ul>
<li>BSD_SUCCESS = Operation successful.</li>
<li>BSD_ERROR_SOCKET = Socket invalid.</li>
<li>BSD_ERROR_PARAMETER = Invalid or not supported parameters.</li>
</ul>
</dd></dl>
<p>The function <b>bind</b> assigns a name to an unnamed socket. The name represents the local address and port of the communication end point.</p>
<p>The argument <em>sock</em> specifies a socket descriptor returned from a previous call to <a class="el" href="group__bsd__routines.html#gabd21dff339393ec8e83b439d1120df71">socket</a>.</p>
<p>The argument <em>addr</em> is a pointer to the <a class="el" href="group__bsd__routines.html#struct_s_o_c_k_a_d_d_r" title="Generic Socket Address structure.">SOCKADDR</a> structure containing the local address and port of the socket.</p>
<p>The argument <em>addrlen</em> specifies the length of the <a class="el" href="group__bsd__routines.html#struct_s_o_c_k_a_d_d_r" title="Generic Socket Address structure.">SOCKADDR</a> structure.</p>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>You must call the <a class="el" href="group__bsd__routines.html#gabd21dff339393ec8e83b439d1120df71">socket</a> function before any other function calls to the BSD socket.</li>
<li>If a negative number is returned, it represents an error code.</li>
</ul>
</dd></dl>
<p><b>Code Example</b> </p>
<div class="fragment"><div class="line"><span class="comment">//----------------------------------------------------------------------------</span></div>
<div class="line"><span class="comment">//  Thread &#39;Server&#39;: BSD Server socket process</span></div>
<div class="line"><span class="comment">//----------------------------------------------------------------------------</span></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> Server (<span class="keywordtype">void</span> <span class="keyword">const</span> *arg) {</div>
<div class="line">  <a class="code" href="rl__net_8h.html#struct_s_o_c_k_a_d_d_r___i_n" title="IPv4 Socket Address structure.">SOCKADDR_IN</a> addr;</div>
<div class="line">  <span class="keywordtype">int</span> sock, sd, res;</div>
<div class="line">  <span class="keywordtype">int</span> type = (int)arg;</div>
<div class="line">  <span class="keywordtype">char</span> dbuf[4];</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">while</span> (1) {</div>
<div class="line">    sock = <a class="code" href="group__bsd__routines.html#gabd21dff339393ec8e83b439d1120df71" title="Create a communication endpoint called socket.">socket</a> (<a class="code" href="rl__net_8h.html#a9930604d0e32588eae76f43ca38e7826" title="Internet Address Family (UDP, TCP)">AF_INET</a>, type, 0);</div>
<div class="line"></div>
<div class="line">    addr.<a class="code" href="rl__net_8h.html#a17c017619a9612c083063a3438ac4b5e" title="Port.">sin_port</a>        = <a class="code" href="rl__net_8h.html#af3a256b18d0645af51564e63fec1bbbb">htons</a>(PORT_NUM);</div>
<div class="line">    addr.<a class="code" href="rl__net_8h.html#a321ed882a4b4cd66d1b9ad64ababd67e" title="Socket domain.">sin_family</a>      = <a class="code" href="rl__net_8h.html#a3f5da0b5be27fe31ec7cc11bfa8d1a25" title="Internet Address Family (UDP, TCP)">PF_INET</a>;</div>
<div class="line">    addr.<a class="code" href="rl__net_8h.html#a92b552b33b68a46c97a8d27a13a8bfb6" title="IP address.">sin_addr</a>.s_addr = <a class="code" href="rl__net_8h.html#a5d1940045dc2e7de552f3d4ff13a74ab" title="BSD Internet Addresses.">INADDR_ANY</a>;</div>
<div class="line"></div>
<div class="line">    <a class="code" href="group__bsd__routines.html#ga03a7134a282d45095ea30edb8e1cd076" title="Assign a local address and port to a socket.">bind</a> (sock, (<a class="code" href="group__bsd__routines.html#struct_s_o_c_k_a_d_d_r" title="Generic Socket Address structure.">SOCKADDR</a> *)&amp;addr, <span class="keyword">sizeof</span>(addr));</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (type == <a class="code" href="rl__net_8h.html#a249394484f9410a2e3f8eba24657feb9" title="BSD Socket Type.">SOCK_STREAM</a>) {</div>
<div class="line">      <a class="code" href="group__bsd__routines.html#ga7005ffbeeff92be5394ff3244da79028" title="Set a socket in a listening mode.">listen</a> (sock, 1);</div>
<div class="line">      sd = <a class="code" href="group__bsd__routines.html#ga18e88467cfdbc3c361d53b9f928a87ab" title="Accept connect request for a listening socket.">accept</a> (sock, NULL, NULL);</div>
<div class="line">      <a class="code" href="group__bsd__routines.html#gad272c8891ecce101c35bf18e3dc03d38" title="Close socket and release socket descriptor.">closesocket</a> (sock);</div>
<div class="line">      sock = sd;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">while</span> (1) {</div>
<div class="line">      res = <a class="code" href="group__bsd__routines.html#gae13b0fcffdc4f2c181a1def0b641ead4" title="Receive data on already connected socket.">recv</a> (sock, dbuf, <span class="keyword">sizeof</span> (dbuf), 0);</div>
<div class="line">      <span class="keywordflow">if</span> (res &lt;= 0) {</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">      }</div>
<div class="line">      <span class="keywordflow">if</span> (dbuf[0] == BLINKLED) {</div>
<div class="line">        LED_Out (dbuf[1]);</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">    <a class="code" href="group__bsd__routines.html#gad272c8891ecce101c35bf18e3dc03d38" title="Close socket and release socket descriptor.">closesocket</a> (sock);</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
</div>
<a class="anchor" id="gad272c8891ecce101c35bf18e3dc03d38"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int closesocket </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>sock</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Close socket and release socket descriptor. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">sock</td><td>socket descriptor obtained with <a class="el" href="group__bsd__routines.html#gabd21dff339393ec8e83b439d1120df71">socket</a>. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>status information:<ul>
<li>BSD_SUCCESS = Operation successful.</li>
<li>BSD_ERROR_SOCKET = Socket invalid.</li>
<li>BSD_ERROR_WOULDBLOCK = Function would block in non-blocking mode.</li>
<li>BSD_ERROR_LOCKED = Socket is locked by another task.</li>
</ul>
</dd></dl>
<p>The function <b>closesocket</b> closes an existing socket and releases the socket descriptor. Further references to sock fail with BSD_ERROR_SOCKET error code.</p>
<p>The argument <em>sock</em> specifies a socket descriptor returned from a previous call to <a class="el" href="group__bsd__routines.html#gabd21dff339393ec8e83b439d1120df71">socket</a>.</p>
<p>In blocking mode, which is enabled if the system detects RTX environment, this functions will wait until a socket is closed. In non blocking mode, you must call the <b>closesocket</b> function again if the error code BSD_ERROR_WOULDBLOCK is returned.</p>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>You must call the <a class="el" href="group__bsd__routines.html#gabd21dff339393ec8e83b439d1120df71">socket</a> function before any other function calls to the BSD socket.</li>
<li>If a negative number is returned, it represents an error code.</li>
</ul>
</dd></dl>
<p><b>Code Example</b> </p>
<div class="fragment"><div class="line"><span class="comment">//---------------------------------------------------------------------------</span></div>
<div class="line"><span class="comment">//  Thread &#39;Server&#39;: BSD Server socket process</span></div>
<div class="line"><span class="comment">//---------------------------------------------------------------------------</span></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> Server (<span class="keywordtype">void</span> <span class="keyword">const</span> *arg) {</div>
<div class="line">  <a class="code" href="rl__net_8h.html#struct_s_o_c_k_a_d_d_r___i_n" title="IPv4 Socket Address structure.">SOCKADDR_IN</a> addr;</div>
<div class="line">  <span class="keywordtype">int</span> sock, sd, res, addrlen;</div>
<div class="line">  <span class="keywordtype">int</span> type = (int)arg;</div>
<div class="line">  <span class="keywordtype">char</span> dbuf[4];</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">while</span> (1) {</div>
<div class="line">    sock = <a class="code" href="group__bsd__routines.html#gabd21dff339393ec8e83b439d1120df71" title="Create a communication endpoint called socket.">socket</a> (<a class="code" href="rl__net_8h.html#a9930604d0e32588eae76f43ca38e7826" title="Internet Address Family (UDP, TCP)">AF_INET</a>, type, 0);</div>
<div class="line"></div>
<div class="line">    addr.<a class="code" href="rl__net_8h.html#a17c017619a9612c083063a3438ac4b5e" title="Port.">sin_port</a>        = <a class="code" href="rl__net_8h.html#af3a256b18d0645af51564e63fec1bbbb">htons</a>(PORT_NUM);</div>
<div class="line">    addr.<a class="code" href="rl__net_8h.html#a321ed882a4b4cd66d1b9ad64ababd67e" title="Socket domain.">sin_family</a>      = <a class="code" href="rl__net_8h.html#a3f5da0b5be27fe31ec7cc11bfa8d1a25" title="Internet Address Family (UDP, TCP)">PF_INET</a>;</div>
<div class="line">    addr.<a class="code" href="rl__net_8h.html#a92b552b33b68a46c97a8d27a13a8bfb6" title="IP address.">sin_addr</a>.s_addr = <a class="code" href="rl__net_8h.html#a5d1940045dc2e7de552f3d4ff13a74ab" title="BSD Internet Addresses.">INADDR_ANY</a>;</div>
<div class="line"></div>
<div class="line">    <a class="code" href="group__bsd__routines.html#ga03a7134a282d45095ea30edb8e1cd076" title="Assign a local address and port to a socket.">bind</a> (sock, (<a class="code" href="group__bsd__routines.html#struct_s_o_c_k_a_d_d_r" title="Generic Socket Address structure.">SOCKADDR</a> *)&amp;addr, <span class="keyword">sizeof</span>(addr));</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (type == <a class="code" href="rl__net_8h.html#a249394484f9410a2e3f8eba24657feb9" title="BSD Socket Type.">SOCK_STREAM</a>) {</div>
<div class="line">      <a class="code" href="group__bsd__routines.html#ga7005ffbeeff92be5394ff3244da79028" title="Set a socket in a listening mode.">listen</a> (sock, 1);</div>
<div class="line">      sd = <a class="code" href="group__bsd__routines.html#ga18e88467cfdbc3c361d53b9f928a87ab" title="Accept connect request for a listening socket.">accept</a> (sock, NULL, NULL);</div>
<div class="line">      <a class="code" href="group__bsd__routines.html#gad272c8891ecce101c35bf18e3dc03d38" title="Close socket and release socket descriptor.">closesocket</a> (sock);</div>
<div class="line">      sock = sd;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">while</span> (1) {</div>
<div class="line">    addrlen = <span class="keyword">sizeof</span> (addr);</div>
<div class="line">      res = <a class="code" href="group__bsd__routines.html#gac6b00a29e8f1664d7ba4a70bfb92d9db" title="Receive data from endpoint node.">recvfrom</a> (sock, dbuf, <span class="keyword">sizeof</span> (dbuf), 0, addr, &amp;addrlen);</div>
<div class="line">      <span class="keywordflow">if</span> (res &lt;= 0) {</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">      }</div>
<div class="line">      procrec ((uint8_t *)dbuf);</div>
<div class="line">      printf (<span class="stringliteral">&quot;Remote IP: %d.%d.%d.%d\n&quot;</span>,addr.<a class="code" href="rl__net_8h.html#a92b552b33b68a46c97a8d27a13a8bfb6" title="IP address.">sin_addr</a>.s_b1,</div>
<div class="line">                                         addr.<a class="code" href="rl__net_8h.html#a92b552b33b68a46c97a8d27a13a8bfb6" title="IP address.">sin_addr</a>.s_b2,</div>
<div class="line">                                         addr.<a class="code" href="rl__net_8h.html#a92b552b33b68a46c97a8d27a13a8bfb6" title="IP address.">sin_addr</a>.s_b3,</div>
<div class="line">                                         addr.<a class="code" href="rl__net_8h.html#a92b552b33b68a46c97a8d27a13a8bfb6" title="IP address.">sin_addr</a>.s_b4);</div>
<div class="line">      printf (<span class="stringliteral">&quot;Remote port: %d\n&quot;</span>,<a class="code" href="rl__net_8h.html#aaf82f29d63af29bd83e76d8f7122cf47">ntohs</a> (addr.<a class="code" href="rl__net_8h.html#a17c017619a9612c083063a3438ac4b5e" title="Port.">sin_port</a>));</div>
<div class="line">    }</div>
<div class="line">    <a class="code" href="group__bsd__routines.html#gad272c8891ecce101c35bf18e3dc03d38" title="Close socket and release socket descriptor.">closesocket</a> (sock);</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
</div>
<a class="anchor" id="gadced863676ed93d1334ba8abef937dd1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int connect </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>sock</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__bsd__routines.html#struct_s_o_c_k_a_d_d_r">SOCKADDR</a> *&#160;</td>
          <td class="paramname"><em>addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>addrlen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Connect a socket to a remote host. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">sock</td><td>socket descriptor obtained with <a class="el" href="group__bsd__routines.html#gabd21dff339393ec8e83b439d1120df71">socket</a>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">addr</td><td>structure containing remote IP address and port. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">addrlen</td><td>length of <a class="el" href="group__bsd__routines.html#struct_s_o_c_k_a_d_d_r">SOCKADDR</a> structure. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>status information:<ul>
<li>BSD_SUCCESS = Operation successful.</li>
<li>BSD_ERROR_SOCKET = Socket invalid or in invalid state.</li>
<li>BSD_ERROR_PARAMETER = Invalid or not supported parameters.</li>
<li>BSD_ERROR_WOULDBLOCK = Function would block in non-blocking mode.</li>
<li>BSD_ERROR_CLOSED = Remote node has closed the connection.</li>
<li>BSD_ERROR = Error in underlying native socket.</li>
</ul>
</dd></dl>
<p>The function <b>connect</b> assigns the address of the peer communication end point. For <b>SOCK_STREAM</b> type socket, a connection is established between the end points. For <b>SOCK_DGRAM</b> type socket, an address filter is established between the end points. The address filter is changed with another <b>connect</b> function.</p>
<p>In blocking mode, which is enabled if the system detects RTX environment, this functions waits for a connection to be established. In non blocking mode, you must call the connect function again if the error code <code>BSD_ERROR_WOULDBLOCK</code> is returned.</p>
<p>The argument <em>sock</em> specifies a socket descriptor returned from a previous call to <a class="el" href="group__bsd__routines.html#gabd21dff339393ec8e83b439d1120df71">socket</a>.</p>
<p>The argument <em>addr</em> is a pointer to the <code><a class="el" href="group__bsd__routines.html#struct_s_o_c_k_a_d_d_r" title="Generic Socket Address structure.">SOCKADDR</a></code> structure that contains the end point node IP address and port number.</p>
<p>The argument <em>addrlen</em> specifies the length of <em><a class="el" href="group__bsd__routines.html#struct_s_o_c_k_a_d_d_r" title="Generic Socket Address structure.">SOCKADDR</a></em> structure.</p>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>You must call the <a class="el" href="group__bsd__routines.html#gabd21dff339393ec8e83b439d1120df71">socket</a> function before any other function calls to the BSD socket.</li>
<li>If a negative number is returned, it represents an error code.</li>
</ul>
</dd></dl>
<p><b>Code Example</b> </p>
<div class="fragment"><div class="line"><span class="comment">//----------------------------------------------------------------------------</span></div>
<div class="line"><span class="comment">//  Thread &#39;Client&#39;: BSD Client socket process</span></div>
<div class="line"><span class="comment">//----------------------------------------------------------------------------</span></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> Client (<span class="keywordtype">void</span> <span class="keyword">const</span> *arg) {</div>
<div class="line">  <a class="code" href="rl__net_8h.html#struct_s_o_c_k_a_d_d_r___i_n" title="IPv4 Socket Address structure.">SOCKADDR_IN</a> addr;</div>
<div class="line">  <span class="keywordtype">int</span> sock, res;</div>
<div class="line">  <span class="keywordtype">char</span> dbuf[4];</div>
<div class="line">  uint8_t p2val,lshf;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">while</span> (1) {</div>
<div class="line">    sock = <a class="code" href="group__bsd__routines.html#gabd21dff339393ec8e83b439d1120df71" title="Create a communication endpoint called socket.">socket</a> (<a class="code" href="rl__net_8h.html#a9930604d0e32588eae76f43ca38e7826" title="Internet Address Family (UDP, TCP)">AF_INET</a>, SOCKTYPE, 0);</div>
<div class="line"></div>
<div class="line">    addr.<a class="code" href="rl__net_8h.html#a17c017619a9612c083063a3438ac4b5e" title="Port.">sin_port</a>      = <a class="code" href="rl__net_8h.html#af3a256b18d0645af51564e63fec1bbbb">htons</a>(PORT_NUM);</div>
<div class="line">    addr.<a class="code" href="rl__net_8h.html#a321ed882a4b4cd66d1b9ad64ababd67e" title="Socket domain.">sin_family</a>    = <a class="code" href="rl__net_8h.html#a3f5da0b5be27fe31ec7cc11bfa8d1a25" title="Internet Address Family (UDP, TCP)">PF_INET</a>;</div>
<div class="line">    addr.<a class="code" href="rl__net_8h.html#a92b552b33b68a46c97a8d27a13a8bfb6" title="IP address.">sin_addr</a>.s_b1 = IP1;</div>
<div class="line">    addr.<a class="code" href="rl__net_8h.html#a92b552b33b68a46c97a8d27a13a8bfb6" title="IP address.">sin_addr</a>.s_b2 = IP2;</div>
<div class="line">    addr.<a class="code" href="rl__net_8h.html#a92b552b33b68a46c97a8d27a13a8bfb6" title="IP address.">sin_addr</a>.s_b3 = IP3;</div>
<div class="line">    addr.<a class="code" href="rl__net_8h.html#a92b552b33b68a46c97a8d27a13a8bfb6" title="IP address.">sin_addr</a>.s_b4 = IP4;</div>
<div class="line"></div>
<div class="line">    <a class="code" href="group__bsd__routines.html#gadced863676ed93d1334ba8abef937dd1" title="Connect a socket to a remote host.">connect</a> (sock, (<a class="code" href="group__bsd__routines.html#struct_s_o_c_k_a_d_d_r" title="Generic Socket Address structure.">SOCKADDR</a> *)&amp;addr, <span class="keyword">sizeof</span> (addr));</div>
<div class="line"></div>
<div class="line">    lshf  = 1;</div>
<div class="line">    p2val = 0x01;</div>
<div class="line">    <span class="keywordflow">while</span> (1) {</div>
<div class="line">      <span class="comment">// Shift the LEDs </span></div>
<div class="line">      LED_Out (p2val);</div>
<div class="line">      p2val = lshf ? (p2val &lt;&lt; 1) : (p2val &gt;&gt; 1);</div>
<div class="line">      <span class="keywordflow">if</span> (p2val == 0x80) lshf = 0;</div>
<div class="line">      <span class="keywordflow">if</span> (p2val == 0x01) lshf = 1;</div>
<div class="line">    </div>
<div class="line">      <span class="comment">// Send the data to LED Server.</span></div>
<div class="line">      dbuf[0] = BLINKLED;</div>
<div class="line">      dbuf[1] = p2val;</div>
<div class="line">      res = <a class="code" href="group__bsd__routines.html#ga27f7859e634a2cd0ab98219b5092f7f7" title="Send data on already connected socket.">send</a> (sock, (<span class="keywordtype">char</span> *)&amp;dbuf, 2, 0);</div>
<div class="line">      <span class="keywordflow">if</span> (res &lt; 0) {</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">      }</div>
<div class="line">      osDelay (100 * SPEED);</div>
<div class="line">    }</div>
<div class="line">    <a class="code" href="group__bsd__routines.html#gad272c8891ecce101c35bf18e3dc03d38" title="Close socket and release socket descriptor.">closesocket</a> (sock);</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
</div>
<a class="anchor" id="gad5213a5aefe3d46dc5aa0c5813c06b1d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="rl__net_8h.html#struct_h_o_s_t_e_n_t">HOSTENT</a> * gethostbyname </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>err</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Retrieve host IP address from host name. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">name</td><td>host name. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">err</td><td>returned error code:<ul>
<li>BSD_SUCCESS = Operation successful.</li>
<li>BSD_ERROR_LOCKED = Function is locked by another task.</li>
<li>BSD_ERROR_WOULDBLOCK = Function would block in non-blocking mode.</li>
<li>BSD_ERROR_PARAMETER = Invalid parameter.</li>
<li>BSD_ERROR_NONAME = Host name does not exist.</li>
<li>BSD_ERROR_TIMEOUT = DNS server response timeout.</li>
<li>BSD_ERROR = Generic error. </li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>status information:<ul>
<li><a class="el" href="rl__net_8h.html#struct_h_o_s_t_e_n_t">HOSTENT</a> result structure or</li>
<li>NULL in case of error.</li>
</ul>
</dd></dl>
<p>The function <b>gethostbyname</b> retrieves host information corresponding to a host name from a host database.</p>
<p>The argument <em>name</em> is a pointer to the null-terminated name of the host to resolve.</p>
<p>The argument <em>err</em> is a pointer to the return error code.</p>
<dl class="section note"><dt>Note</dt><dd>If a negative number is returned, it represents an error code.</dd></dl>
<p><b>Code Example</b> </p>
<div class="fragment"><div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *hosts[] = {</div>
<div class="line">  <span class="stringliteral">&quot;www.google.com&quot;</span>,</div>
<div class="line">  <span class="stringliteral">&quot;www.keil.com&quot;</span>,</div>
<div class="line">  <span class="stringliteral">&quot;www.microsoft.com&quot;</span>,</div>
<div class="line">  <span class="stringliteral">&quot;www.yahoo.com&quot;</span>,</div>
<div class="line">  NULL</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> dns_task (<span class="keywordtype">void</span>) {</div>
<div class="line">  <span class="keywordtype">int</span> i, j, err;</div>
<div class="line">  <a class="code" href="rl__net_8h.html#struct_h_o_s_t_e_n_t" title="BSD Host Entry structure.">HOSTENT</a> *host;</div>
<div class="line">  <a class="code" href="rl__net_8h.html#struct_i_n___a_d_d_r" title="Generic IPv4 Address structure.">IN_ADDR</a> *addr;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">for</span> (i = 0; ; i++) {</div>
<div class="line">    <span class="keywordflow">if</span> (!hosts[i]) i = 0;</div>
<div class="line">    printf (<span class="stringliteral">&quot;Host: %s\n&quot;</span>,hosts[i]);</div>
<div class="line"></div>
<div class="line">    host = <a class="code" href="group__bsd__routines.html#gad5213a5aefe3d46dc5aa0c5813c06b1d" title="Retrieve host IP address from host name.">gethostbyname</a> (hosts[i], &amp;err);</div>
<div class="line">    <span class="keywordflow">if</span> (host == NULL) {</div>
<div class="line">      <span class="keywordflow">if</span> (err == SCK_ENONAME) {</div>
<div class="line">        printf (<span class="stringliteral">&quot;Hostname does not exist\n&quot;</span>);</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (host-&gt;<a class="code" href="rl__net_8h.html#aa94ed2e671740aa0ccd82e8d18abccae" title="Address Type: AF_INET, AF_NETBIOS.">h_addrtype</a> == <a class="code" href="rl__net_8h.html#a9930604d0e32588eae76f43ca38e7826" title="Internet Address Family (UDP, TCP)">AF_INET</a>) {</div>
<div class="line">      <span class="keywordflow">for</span> (j = 0; host-&gt;<a class="code" href="rl__net_8h.html#a058204dad180c9850b3ffaf6b32f5b4c" title="Pointer to an array of IPv4 addresses.">h_addr_list</a>[j]; j++) {</div>
<div class="line">        addr = (<a class="code" href="rl__net_8h.html#struct_i_n___a_d_d_r" title="Generic IPv4 Address structure.">IN_ADDR</a> *)host-&gt;<a class="code" href="rl__net_8h.html#a058204dad180c9850b3ffaf6b32f5b4c" title="Pointer to an array of IPv4 addresses.">h_addr_list</a>[j];</div>
<div class="line">        printf(<span class="stringliteral">&quot;IP Address: %d.%d.%d.%d\n&quot;</span>,addr-&gt;s_b1,</div>
<div class="line">                                           addr-&gt;s_b2,</div>
<div class="line">                                           addr-&gt;s_b3,</div>
<div class="line">                                           addr-&gt;s_b4);</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">    os_dly_wait (300);</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
</div>
<a class="anchor" id="ga9c2820e49f50f3757136f8bd928ab279"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int getpeername </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>sock</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__bsd__routines.html#struct_s_o_c_k_a_d_d_r">SOCKADDR</a> *&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>namelen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Retrieve IP address and port number of the endpoint node. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">sock</td><td>socket descriptor obtained with <a class="el" href="group__bsd__routines.html#gabd21dff339393ec8e83b439d1120df71">socket</a>. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">name</td><td>structure that will receive IP address and port number. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">namelen</td><td>length of <a class="el" href="group__bsd__routines.html#struct_s_o_c_k_a_d_d_r">SOCKADDR</a> structure. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>status information:<ul>
<li>BSD_SUCCESS = Operation successful.</li>
<li>BSD_ERROR_SOCKET = Socket invalid.</li>
<li>BSD_ERROR = Socket is not created.</li>
</ul>
</dd></dl>
<p>The function <b>getpeername</b> retrieves the address of the peer to which a socket is connected.</p>
<p>The argument <em>sock</em> specifies a socket descriptor returned from a previous call to <a class="el" href="group__bsd__routines.html#gabd21dff339393ec8e83b439d1120df71">socket</a>.</p>
<p>The argument <em>name</em> is a pointer to the <a class="el" href="group__bsd__routines.html#struct_s_o_c_k_a_d_d_r" title="Generic Socket Address structure.">SOCKADDR</a> structure. If name is not <code>NULL</code>, the remote end IP address and port number is filled in.</p>
<p>The argument <em>namelen</em> is a pointer to the address length. It should initially contain the amount of space pointed to by <em>name</em>. On return it contains the actual length of the address returned in bytes.</p>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>You must call the <a class="el" href="group__bsd__routines.html#gabd21dff339393ec8e83b439d1120df71">socket</a> function before any other function calls to the BSD socket.</li>
<li>If a negative number is returned, it represents an error code.</li>
</ul>
</dd></dl>
<p><b>Code Example</b> </p>
<div class="fragment"><div class="line"><span class="comment">//---------------------------------------------------------------------------</span></div>
<div class="line"><span class="comment">//  Thread &#39;Server&#39;: BSD Server socket process</span></div>
<div class="line"><span class="comment">//---------------------------------------------------------------------------</span></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> Server (<span class="keywordtype">void</span> <span class="keyword">const</span> *arg) {</div>
<div class="line">  <a class="code" href="rl__net_8h.html#struct_s_o_c_k_a_d_d_r___i_n" title="IPv4 Socket Address structure.">SOCKADDR_IN</a> addr;</div>
<div class="line">  <span class="keywordtype">int</span> sock, sd, res, addrlen;</div>
<div class="line">  <span class="keywordtype">int</span> type = (int)arg;</div>
<div class="line">  <span class="keywordtype">char</span> dbuf[4];</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">while</span> (1) {</div>
<div class="line">    sock = <a class="code" href="group__bsd__routines.html#gabd21dff339393ec8e83b439d1120df71" title="Create a communication endpoint called socket.">socket</a> (<a class="code" href="rl__net_8h.html#a9930604d0e32588eae76f43ca38e7826" title="Internet Address Family (UDP, TCP)">AF_INET</a>, type, 0);</div>
<div class="line"></div>
<div class="line">    addr.<a class="code" href="rl__net_8h.html#a17c017619a9612c083063a3438ac4b5e" title="Port.">sin_port</a>        = <a class="code" href="rl__net_8h.html#af3a256b18d0645af51564e63fec1bbbb">htons</a>(PORT_NUM);</div>
<div class="line">    addr.<a class="code" href="rl__net_8h.html#a321ed882a4b4cd66d1b9ad64ababd67e" title="Socket domain.">sin_family</a>      = <a class="code" href="rl__net_8h.html#a3f5da0b5be27fe31ec7cc11bfa8d1a25" title="Internet Address Family (UDP, TCP)">PF_INET</a>;</div>
<div class="line">    addr.<a class="code" href="rl__net_8h.html#a92b552b33b68a46c97a8d27a13a8bfb6" title="IP address.">sin_addr</a>.s_addr = <a class="code" href="rl__net_8h.html#a5d1940045dc2e7de552f3d4ff13a74ab" title="BSD Internet Addresses.">INADDR_ANY</a>;</div>
<div class="line"></div>
<div class="line">    <a class="code" href="group__bsd__routines.html#ga03a7134a282d45095ea30edb8e1cd076" title="Assign a local address and port to a socket.">bind</a> (sock, (<a class="code" href="group__bsd__routines.html#struct_s_o_c_k_a_d_d_r" title="Generic Socket Address structure.">SOCKADDR</a> *)&amp;addr, <span class="keyword">sizeof</span>(addr));</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (type == <a class="code" href="rl__net_8h.html#a249394484f9410a2e3f8eba24657feb9" title="BSD Socket Type.">SOCK_STREAM</a>) {</div>
<div class="line">      <a class="code" href="group__bsd__routines.html#ga7005ffbeeff92be5394ff3244da79028" title="Set a socket in a listening mode.">listen</a> (sock, 1);</div>
<div class="line">      sd = <a class="code" href="group__bsd__routines.html#ga18e88467cfdbc3c361d53b9f928a87ab" title="Accept connect request for a listening socket.">accept</a> (sock, NULL, NULL);</div>
<div class="line">      <a class="code" href="group__bsd__routines.html#gad272c8891ecce101c35bf18e3dc03d38" title="Close socket and release socket descriptor.">closesocket</a> (sock);</div>
<div class="line">      sock = sd;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">while</span> (1) {</div>
<div class="line">    addrlen = <span class="keyword">sizeof</span> (addr);</div>
<div class="line">      res = <a class="code" href="group__bsd__routines.html#gac6b00a29e8f1664d7ba4a70bfb92d9db" title="Receive data from endpoint node.">recvfrom</a> (sock, dbuf, <span class="keyword">sizeof</span> (dbuf), 0, addr, &amp;addrlen);</div>
<div class="line">      <span class="keywordflow">if</span> (res &lt;= 0) {</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">      }</div>
<div class="line">      procrec ((uint8_t *)dbuf);</div>
<div class="line">    <a class="code" href="group__bsd__routines.html#ga9c2820e49f50f3757136f8bd928ab279" title="Retrieve IP address and port number of the endpoint node.">getpeername</a> (sock, (<a class="code" href="group__bsd__routines.html#struct_s_o_c_k_a_d_d_r" title="Generic Socket Address structure.">SOCKADDR</a> *)&amp;addr, &amp;addrlen);</div>
<div class="line">      printf (<span class="stringliteral">&quot;Remote IP: %d.%d.%d.%d\n&quot;</span>,addr.<a class="code" href="rl__net_8h.html#a92b552b33b68a46c97a8d27a13a8bfb6" title="IP address.">sin_addr</a>.s_b1,</div>
<div class="line">                                         addr.<a class="code" href="rl__net_8h.html#a92b552b33b68a46c97a8d27a13a8bfb6" title="IP address.">sin_addr</a>.s_b2,</div>
<div class="line">                                         addr.<a class="code" href="rl__net_8h.html#a92b552b33b68a46c97a8d27a13a8bfb6" title="IP address.">sin_addr</a>.s_b3,</div>
<div class="line">                                         addr.<a class="code" href="rl__net_8h.html#a92b552b33b68a46c97a8d27a13a8bfb6" title="IP address.">sin_addr</a>.s_b4);</div>
<div class="line">      printf (<span class="stringliteral">&quot;Remote port: %d\n&quot;</span>,<a class="code" href="rl__net_8h.html#aaf82f29d63af29bd83e76d8f7122cf47">ntohs</a> (addr.<a class="code" href="rl__net_8h.html#a17c017619a9612c083063a3438ac4b5e" title="Port.">sin_port</a>));</div>
<div class="line">    }</div>
<div class="line">    <a class="code" href="group__bsd__routines.html#gad272c8891ecce101c35bf18e3dc03d38" title="Close socket and release socket descriptor.">closesocket</a> (sock);</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
</div>
<a class="anchor" id="gaccbeb567d8c775d4405dc556433bb592"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int getsockname </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>sock</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__bsd__routines.html#struct_s_o_c_k_a_d_d_r">SOCKADDR</a> *&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>namelen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Retrieve local IP address and port number. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">sock</td><td>socket descriptor obtained with <a class="el" href="group__bsd__routines.html#gabd21dff339393ec8e83b439d1120df71">socket</a>. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">name</td><td>structure that will receive IP address and port number. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">namelen</td><td>length of <a class="el" href="group__bsd__routines.html#struct_s_o_c_k_a_d_d_r">SOCKADDR</a> structure. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>status information:<ul>
<li>BSD_SUCCESS = Operation successful.</li>
<li>BSD_ERROR_SOCKET = Socket invalid.</li>
<li>BSD_ERROR = Socket is not created.</li>
</ul>
</dd></dl>
<p>The function <b>getsockname</b> retrieves the local address for a socket.</p>
<p>The argument <em>sock</em> specifies a socket descriptor returned from a previous call to <a class="el" href="group__bsd__routines.html#gabd21dff339393ec8e83b439d1120df71">socket</a>.</p>
<p>The argument <em>name</em> is a pointer to the <a class="el" href="group__bsd__routines.html#struct_s_o_c_k_a_d_d_r" title="Generic Socket Address structure.">SOCKADDR</a> structure. If name is not <code>NULL</code>, the local IP address and port number is filled in.</p>
<p>The argument <em>namelen</em> is a pointer to the address length. It should initially contain the amount of space pointed to by <em>name</em>. On return it contains the actual length of the address returned in bytes.</p>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>You must call the <a class="el" href="group__bsd__routines.html#gabd21dff339393ec8e83b439d1120df71">socket</a> function before any other function calls to the BSD socket.</li>
<li>If a negative number is returned, it represents an error code.</li>
</ul>
</dd></dl>
<p><b>Code Example</b> </p>
<div class="fragment"><div class="line"><span class="comment">//---------------------------------------------------------------------------</span></div>
<div class="line"><span class="comment">//  Thread &#39;Server&#39;: BSD Server socket process</span></div>
<div class="line"><span class="comment">//---------------------------------------------------------------------------</span></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> Server (<span class="keywordtype">void</span> <span class="keyword">const</span> *arg) {</div>
<div class="line">  <a class="code" href="rl__net_8h.html#struct_s_o_c_k_a_d_d_r___i_n" title="IPv4 Socket Address structure.">SOCKADDR_IN</a> addr;</div>
<div class="line">  <span class="keywordtype">int</span> sock, res, addrlen;</div>
<div class="line">  <span class="keywordtype">char</span> dbuf[4];</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">while</span> (1) {</div>
<div class="line">    sock = <a class="code" href="group__bsd__routines.html#gabd21dff339393ec8e83b439d1120df71" title="Create a communication endpoint called socket.">socket</a> (<a class="code" href="rl__net_8h.html#a9930604d0e32588eae76f43ca38e7826" title="Internet Address Family (UDP, TCP)">AF_INET</a>, <a class="code" href="rl__net_8h.html#a4db8b9a846c67404db0b6f014f9a9fdf" title="Datagram Socket (Connectionless)">SOCK_DGRAM</a>, <a class="code" href="rl__net_8h.html#ab332d40b15142f33a88d4fcb1d6a5920" title="UDP Protocol.">IPPROTO_UDP</a>);</div>
<div class="line"></div>
<div class="line">    addr.<a class="code" href="rl__net_8h.html#a17c017619a9612c083063a3438ac4b5e" title="Port.">sin_port</a>        = <a class="code" href="rl__net_8h.html#af3a256b18d0645af51564e63fec1bbbb">htons</a>(1001);</div>
<div class="line">    addr.<a class="code" href="rl__net_8h.html#a321ed882a4b4cd66d1b9ad64ababd67e" title="Socket domain.">sin_family</a>      = <a class="code" href="rl__net_8h.html#a3f5da0b5be27fe31ec7cc11bfa8d1a25" title="Internet Address Family (UDP, TCP)">PF_INET</a>;</div>
<div class="line">    addr.<a class="code" href="rl__net_8h.html#a92b552b33b68a46c97a8d27a13a8bfb6" title="IP address.">sin_addr</a>.s_addr = <a class="code" href="rl__net_8h.html#a5d1940045dc2e7de552f3d4ff13a74ab" title="BSD Internet Addresses.">INADDR_ANY</a>;</div>
<div class="line"></div>
<div class="line">    <a class="code" href="group__bsd__routines.html#ga03a7134a282d45095ea30edb8e1cd076" title="Assign a local address and port to a socket.">bind</a> (sock, (<a class="code" href="group__bsd__routines.html#struct_s_o_c_k_a_d_d_r" title="Generic Socket Address structure.">SOCKADDR</a> *)&amp;addr, <span class="keyword">sizeof</span> (addr));</div>
<div class="line"></div>
<div class="line">    addrlen = <span class="keyword">sizeof</span> (addr);</div>
<div class="line">    <a class="code" href="group__bsd__routines.html#gaccbeb567d8c775d4405dc556433bb592" title="Retrieve local IP address and port number.">getsockname</a> (sock, (<a class="code" href="group__bsd__routines.html#struct_s_o_c_k_a_d_d_r" title="Generic Socket Address structure.">SOCKADDR</a> *)&amp;addr, &amp;addrlen);</div>
<div class="line">    printf (<span class="stringliteral">&quot;Local IP: %d.%d.%d.%d\n&quot;</span>,addr.<a class="code" href="rl__net_8h.html#a92b552b33b68a46c97a8d27a13a8bfb6" title="IP address.">sin_addr</a>.s_b1,</div>
<div class="line">                                      addr.<a class="code" href="rl__net_8h.html#a92b552b33b68a46c97a8d27a13a8bfb6" title="IP address.">sin_addr</a>.s_b2,</div>
<div class="line">                                      addr.<a class="code" href="rl__net_8h.html#a92b552b33b68a46c97a8d27a13a8bfb6" title="IP address.">sin_addr</a>.s_b3,</div>
<div class="line">                                      addr.<a class="code" href="rl__net_8h.html#a92b552b33b68a46c97a8d27a13a8bfb6" title="IP address.">sin_addr</a>.s_b4);</div>
<div class="line">    printf (<span class="stringliteral">&quot;Local port: %d\n&quot;</span>,<a class="code" href="rl__net_8h.html#aaf82f29d63af29bd83e76d8f7122cf47">ntohs</a> (addr.<a class="code" href="rl__net_8h.html#a17c017619a9612c083063a3438ac4b5e" title="Port.">sin_port</a>));</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">while</span> (1) {</div>
<div class="line">      res = <a class="code" href="group__bsd__routines.html#gae13b0fcffdc4f2c181a1def0b641ead4" title="Receive data on already connected socket.">recv</a> (sock, dbuf, <span class="keyword">sizeof</span> (dbuf), 0);</div>
<div class="line">      <span class="keywordflow">if</span> (res &lt;= 0) {</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">      }</div>
<div class="line">      procrec ((uint8_t *)dbuf);</div>
<div class="line">    }</div>
<div class="line">    <a class="code" href="group__bsd__routines.html#gad272c8891ecce101c35bf18e3dc03d38" title="Close socket and release socket descriptor.">closesocket</a> (sock);</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
</div>
<a class="anchor" id="ga0b42eb9e32b55aff7130ef48afd8b885"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ioctlsocket </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>sock</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>cmd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long *&#160;</td>
          <td class="paramname"><em>argp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Control IO mode of a socket. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">sock</td><td>socket descriptor obtained with <a class="el" href="group__bsd__routines.html#gabd21dff339393ec8e83b439d1120df71">socket</a>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cmd</td><td>command to perform:<ul>
<li>FIONBIO = enable non-blocking mode.</li>
<li>FIO_DELAY_ACK = enable delay-ack.</li>
<li>FIO_KEEP_ALIVE = enable keep-alive mode.</li>
<li>FIO_FLOW_CTRL = enable flow-control mode. </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">argp</td><td>command's parameter </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>status information:<ul>
<li>BSD_SUCCESS = Operation successful.</li>
<li>BSD_ERROR_SOCKET = Socket invalid.</li>
<li>BSD_ERROR_PARAMETER = Invalid or not supported parameters.</li>
<li>BSD_ERROR = Socket is not created.</li>
</ul>
</dd></dl>
<p>The function <b>ioctlsocket</b> controls the I/O mode of a socket. It can be used on any socket in any state to set or retrieve some operating parameters of the socket.</p>
<p>The argument <em>sock</em> specifies a socket descriptor returned from a previous call to <a class="el" href="group__bsd__routines.html#gabd21dff339393ec8e83b439d1120df71">socket</a>.</p>
<p>The argument <em>cmd</em> specifies a command to perform on a socket. The following commands are supported: </p>
<table class="doxtable">
<tr>
<th>Command </th><th>Description </th></tr>
<tr>
<td>FIONBIO </td><td>Sets the blocking or non-blocking socket I/O mode </td></tr>
<tr>
<td>FIO_DELAY_ACK </td><td>Sets the delay-ack or normal mode for the stream socket </td></tr>
<tr>
<td>FIO_KEEP_ALIVE</td><td>Sets the keep-alive or timeout mode for the stream socket </td></tr>
<tr>
<td>FIO_FLOW_CTRL </td><td>Sets the receive flow-control or normal mode for the stream socket </td></tr>
</table>
<p>The argument <em>argp</em> specifies a pointer to the command's parameter. <br/>
 For the command <b>FIONBIO</b> the argument values are: </p>
<table class="doxtable">
<tr>
<th>*argp value</th><th>I/O mode </th></tr>
<tr>
<td>0 </td><td>Blocking mode </td></tr>
<tr>
<td>nonzero </td><td>Non-blocking mode </td></tr>
</table>
<p>For the command <b>FIO_DELAY_ACK</b> the argument values are: </p>
<table class="doxtable">
<tr>
<th>*argp value</th><th>Socket mode </th><th>Description</th></tr>
<tr>
<td>0 </td><td>Normal mode </td><td>Waits for an ACK after each sending packet </td></tr>
<tr>
<td>nonzero </td><td>Delay-ack mode</td><td>Eliminates the delayed acknowledge impact and improves the performance for applications sending large amount of data </td></tr>
</table>
<p>For the command <b>FIO_KEEP_ALIVE</b> the argument values are: </p>
<table class="doxtable">
<tr>
<th>*argp value</th><th>Socket mode </th><th>Description</th></tr>
<tr>
<td>0 </td><td>Timeout mode </td><td>After a timeout a stream socket is disconnected </td></tr>
<tr>
<td>nonzero </td><td>Keep-alive mode</td><td>Stream socket sends keep alive segments on timeout to keep a connection alive </td></tr>
</table>
<p>For the command <b>FIO_FLOW_CTRL</b> the argument values are: </p>
<table class="doxtable">
<tr>
<th>*argp value</th><th>Socket mode </th><th>Description</th></tr>
<tr>
<td>0 </td><td>Normal mode </td><td>Stream socket dumps excess data, if the receiving buffer is full </td></tr>
<tr>
<td>nonzero </td><td>Flow-control mode</td><td>Stream socket controls the window size and stops the transmitter, if the receiving buffer is full </td></tr>
</table>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>You must call the <a class="el" href="group__bsd__routines.html#gabd21dff339393ec8e83b439d1120df71">socket</a> function before any other function calls to the BSD socket.</li>
<li>Negative return numbers represent error codes.</li>
<li>The <em>blocking</em> mode is enabled by default in the RTX environment.</li>
</ul>
</dd></dl>
<p><b>Code Example</b> </p>
<div class="fragment"><div class="line"><span class="comment">//---------------------------------------------------------------------------</span></div>
<div class="line"><span class="comment">//  Thread &#39;Server&#39;: BSD Server socket process</span></div>
<div class="line"><span class="comment">//---------------------------------------------------------------------------</span></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> Server (<span class="keywordtype">void</span> <span class="keyword">const</span> *arg) {</div>
<div class="line">  <span class="keywordtype">int</span> sock, res;</div>
<div class="line">  <span class="keywordtype">long</span> sck_mode;</div>
<div class="line"> </div>
<div class="line">  sock = <a class="code" href="group__bsd__routines.html#gabd21dff339393ec8e83b439d1120df71" title="Create a communication endpoint called socket.">socket</a> (<a class="code" href="rl__net_8h.html#a9930604d0e32588eae76f43ca38e7826" title="Internet Address Family (UDP, TCP)">AF_INET</a>, <a class="code" href="rl__net_8h.html#a249394484f9410a2e3f8eba24657feb9" title="BSD Socket Type.">SOCK_STREAM</a>, <a class="code" href="rl__net_8h.html#a94f83c72c1e5e6ef453e47cf59885fb5" title="BSD Socket Protocol.">IPPROTO_TCP</a>);</div>
<div class="line"></div>
<div class="line">  <span class="comment">// 0= blocking, 1= non-blocking </span></div>
<div class="line">  sck_mode = 1;</div>
<div class="line">  res = <a class="code" href="group__bsd__routines.html#ga0b42eb9e32b55aff7130ef48afd8b885" title="Control IO mode of a socket.">ioctlsocket</a> (sock, <a class="code" href="rl__net_8h.html#af48a6e38eb0ae226621514b44b9844eb" title="BSD Socket ioctl commands.">FIONBIO</a>, &amp;sck_mode);</div>
<div class="line">  <span class="keywordflow">if</span> (res == SCK_SUCCESS) {</div>
<div class="line">    printf (<span class="stringliteral">&quot;Nonblocking mode enabled.\n&quot;</span>);</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">else</span> {</div>
<div class="line">    printf (<span class="stringliteral">&quot;ioctlsocket() error\n!&quot;</span>);</div>
<div class="line">  }</div>
<div class="line">  ..</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
</div>
<a class="anchor" id="ga7005ffbeeff92be5394ff3244da79028"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int listen </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>sock</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>backlog</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set a socket in a listening mode. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">sock</td><td>socket descriptor obtained with <a class="el" href="group__bsd__routines.html#gabd21dff339393ec8e83b439d1120df71">socket</a>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">backlog</td><td>number of connection requests that can be queued. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>status information:<ul>
<li>BSD_SUCCESS = Operation successful.</li>
<li>BSD_ERROR_SOCKET = Socket invalid.</li>
<li>BSD_ERROR_PARAMETER = Invalid or not supported parameters.</li>
<li>BSD_ERROR = Not enough sockets available for backlog.</li>
</ul>
</dd></dl>
<p>The function <b>listen</b> sets the specified socket to listening mode. Before calling the <b>listen</b> function, the <a class="el" href="group__bsd__routines.html#ga03a7134a282d45095ea30edb8e1cd076">bind</a> function must be called.</p>
<p>The argument <em>sock</em> specifies a socket descriptor returned from a previous call to <a class="el" href="group__bsd__routines.html#gabd21dff339393ec8e83b439d1120df71">socket</a>.</p>
<p>The argument <em>backlog</em> specifies a maximum number of connection requests that can be queued.</p>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>You must call the <a class="el" href="group__bsd__routines.html#gabd21dff339393ec8e83b439d1120df71">socket</a> function before any other function calls to the BSD socket.</li>
<li>If a negative number is returned, it represents an error code.</li>
</ul>
</dd></dl>
<p><b>Code Example</b> </p>
<div class="fragment"><div class="line"><span class="comment">//----------------------------------------------------------------------------</span></div>
<div class="line"><span class="comment">//  Thread &#39;Server&#39;: BSD Server socket process</span></div>
<div class="line"><span class="comment">//----------------------------------------------------------------------------</span></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> Server (<span class="keywordtype">void</span> <span class="keyword">const</span> *arg) {</div>
<div class="line">  <a class="code" href="rl__net_8h.html#struct_s_o_c_k_a_d_d_r___i_n" title="IPv4 Socket Address structure.">SOCKADDR_IN</a> addr;</div>
<div class="line">  <span class="keywordtype">int</span> sock, sd, res;</div>
<div class="line">  <span class="keywordtype">int</span> type = (int)arg;</div>
<div class="line">  <span class="keywordtype">char</span> dbuf[4];</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">while</span> (1) {</div>
<div class="line">    sock = <a class="code" href="group__bsd__routines.html#gabd21dff339393ec8e83b439d1120df71" title="Create a communication endpoint called socket.">socket</a> (<a class="code" href="rl__net_8h.html#a9930604d0e32588eae76f43ca38e7826" title="Internet Address Family (UDP, TCP)">AF_INET</a>, type, 0);</div>
<div class="line"></div>
<div class="line">    addr.<a class="code" href="rl__net_8h.html#a17c017619a9612c083063a3438ac4b5e" title="Port.">sin_port</a>        = <a class="code" href="rl__net_8h.html#af3a256b18d0645af51564e63fec1bbbb">htons</a>(PORT_NUM);</div>
<div class="line">    addr.<a class="code" href="rl__net_8h.html#a321ed882a4b4cd66d1b9ad64ababd67e" title="Socket domain.">sin_family</a>      = <a class="code" href="rl__net_8h.html#a3f5da0b5be27fe31ec7cc11bfa8d1a25" title="Internet Address Family (UDP, TCP)">PF_INET</a>;</div>
<div class="line">    addr.<a class="code" href="rl__net_8h.html#a92b552b33b68a46c97a8d27a13a8bfb6" title="IP address.">sin_addr</a>.s_addr = <a class="code" href="rl__net_8h.html#a5d1940045dc2e7de552f3d4ff13a74ab" title="BSD Internet Addresses.">INADDR_ANY</a>;</div>
<div class="line"></div>
<div class="line">    <a class="code" href="group__bsd__routines.html#ga03a7134a282d45095ea30edb8e1cd076" title="Assign a local address and port to a socket.">bind</a> (sock, (<a class="code" href="group__bsd__routines.html#struct_s_o_c_k_a_d_d_r" title="Generic Socket Address structure.">SOCKADDR</a> *)&amp;addr, <span class="keyword">sizeof</span>(addr));</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (type == <a class="code" href="rl__net_8h.html#a249394484f9410a2e3f8eba24657feb9" title="BSD Socket Type.">SOCK_STREAM</a>) {</div>
<div class="line">      <a class="code" href="group__bsd__routines.html#ga7005ffbeeff92be5394ff3244da79028" title="Set a socket in a listening mode.">listen</a> (sock, 1);</div>
<div class="line">      sd = <a class="code" href="group__bsd__routines.html#ga18e88467cfdbc3c361d53b9f928a87ab" title="Accept connect request for a listening socket.">accept</a> (sock, NULL, NULL);</div>
<div class="line">      <a class="code" href="group__bsd__routines.html#gad272c8891ecce101c35bf18e3dc03d38" title="Close socket and release socket descriptor.">closesocket</a> (sock);</div>
<div class="line">      sock = sd;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">while</span> (1) {</div>
<div class="line">      res = <a class="code" href="group__bsd__routines.html#gae13b0fcffdc4f2c181a1def0b641ead4" title="Receive data on already connected socket.">recv</a> (sock, dbuf, <span class="keyword">sizeof</span> (dbuf), 0);</div>
<div class="line">      <span class="keywordflow">if</span> (res &lt;= 0) {</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">      }</div>
<div class="line">      <span class="keywordflow">if</span> (dbuf[0] == BLINKLED) {</div>
<div class="line">        LED_Out (dbuf[1]);</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">    <a class="code" href="group__bsd__routines.html#gad272c8891ecce101c35bf18e3dc03d38" title="Close socket and release socket descriptor.">closesocket</a> (sock);</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
</div>
<a class="anchor" id="gae13b0fcffdc4f2c181a1def0b641ead4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int recv </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>sock</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Receive data on already connected socket. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">sock</td><td>socket descriptor obtained with <a class="el" href="group__bsd__routines.html#gabd21dff339393ec8e83b439d1120df71">socket</a>. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">buf</td><td>pointer to application data buffer to store the data to. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">len</td><td>size of application data buffer (in bytes). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">flags</td><td>message flags:<ul>
<li>MSG_DONTWAIT = don't wait for data,</li>
<li>MSG_PEEK = peek at incoming data,</li>
<li>0 = for none. </li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>status information:<ul>
<li>Number of bytes received or</li>
<li>BSD_ERROR_SOCKET = Socket invalid or in invalid state.</li>
<li>BSD_ERROR_CLOSED = Remote node has closed the connection.</li>
<li>BSD_ERROR_WOULDBLOCK = Function would block in non-blocking mode.</li>
<li>BSD_ERROR_TIMEOUT = Wait for data timeout in blocking mode.</li>
<li>BSD_ERROR_LOCKED = Socket is locked by another task.</li>
</ul>
</dd></dl>
<p>The function <b>recv</b> receives incoming data that has been queued for the socket. This function can be used with both <b>SOCK_STREAM</b> and <b>SOCK_DGRAM</b> type sockets. It reads as much information as currently available up to the size of the buffer specified.</p>
<p>In blocking mode, which is enabled if the system detects RTX environment, this functions waits for received data. In non blocking mode, you must call the <b>recv</b> function again if the error code BSD_ERROR_WOULDBLOCK is returned.</p>
<p>The argument <em>sock</em> specifies a socket descriptor returned from a previous call to <a class="el" href="group__bsd__routines.html#gabd21dff339393ec8e83b439d1120df71">socket</a>.</p>
<p>The argument <em>buf</em> is a pointer to the application data buffer for storing the data to. If the available data is too large to fit in the supplied application buffer <em>buf</em>, excess bytes are discarded in case of <b>SOCK_DGRAM</b> sockets. For socket types <b>SOCK_STREAM</b>, the data is buffered internally so the application can retrieve all data by multiple calls of <b>recv</b> function.</p>
<p>The argument <em>len</em> specifies the size of the application data buffer. The argument <em>flags</em> specifies the message flags:</p>
<table class="doxtable">
<tr>
<th>Flag </th><th>Description</th></tr>
<tr>
<td>MSG_DONTWAIT</td><td>The function returns with error code <code>BSD_ERROR_WOULDBLOCK</code> or <b>number of bytes</b> sent instead of blocking the socket. </td></tr>
<tr>
<td>MSG_PEEK </td><td>The function peeks at incoming data. The data is copied into the buffer, but is not removed from the input queue. </td></tr>
</table>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>You must call the <a class="el" href="group__bsd__routines.html#gabd21dff339393ec8e83b439d1120df71">socket</a> function before any other function calls to the BSD socket.</li>
<li>If a negative number is returned, it represents an error code.</li>
</ul>
</dd></dl>
<p><b>Code Example</b> </p>
<div class="fragment"><div class="line"><span class="comment">//----------------------------------------------------------------------------</span></div>
<div class="line"><span class="comment">//  Thread &#39;Server&#39;: BSD Server socket process</span></div>
<div class="line"><span class="comment">//----------------------------------------------------------------------------</span></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> Server (<span class="keywordtype">void</span> <span class="keyword">const</span> *arg) {</div>
<div class="line">  <a class="code" href="rl__net_8h.html#struct_s_o_c_k_a_d_d_r___i_n" title="IPv4 Socket Address structure.">SOCKADDR_IN</a> addr;</div>
<div class="line">  <span class="keywordtype">int</span> sock, sd, res;</div>
<div class="line">  <span class="keywordtype">int</span> type = (int)arg;</div>
<div class="line">  <span class="keywordtype">char</span> dbuf[4];</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">while</span> (1) {</div>
<div class="line">    sock = <a class="code" href="group__bsd__routines.html#gabd21dff339393ec8e83b439d1120df71" title="Create a communication endpoint called socket.">socket</a> (<a class="code" href="rl__net_8h.html#a9930604d0e32588eae76f43ca38e7826" title="Internet Address Family (UDP, TCP)">AF_INET</a>, type, 0);</div>
<div class="line"></div>
<div class="line">    addr.<a class="code" href="rl__net_8h.html#a17c017619a9612c083063a3438ac4b5e" title="Port.">sin_port</a>        = <a class="code" href="rl__net_8h.html#af3a256b18d0645af51564e63fec1bbbb">htons</a>(PORT_NUM);</div>
<div class="line">    addr.<a class="code" href="rl__net_8h.html#a321ed882a4b4cd66d1b9ad64ababd67e" title="Socket domain.">sin_family</a>      = <a class="code" href="rl__net_8h.html#a3f5da0b5be27fe31ec7cc11bfa8d1a25" title="Internet Address Family (UDP, TCP)">PF_INET</a>;</div>
<div class="line">    addr.<a class="code" href="rl__net_8h.html#a92b552b33b68a46c97a8d27a13a8bfb6" title="IP address.">sin_addr</a>.s_addr = <a class="code" href="rl__net_8h.html#a5d1940045dc2e7de552f3d4ff13a74ab" title="BSD Internet Addresses.">INADDR_ANY</a>;</div>
<div class="line"></div>
<div class="line">    <a class="code" href="group__bsd__routines.html#ga03a7134a282d45095ea30edb8e1cd076" title="Assign a local address and port to a socket.">bind</a> (sock, (<a class="code" href="group__bsd__routines.html#struct_s_o_c_k_a_d_d_r" title="Generic Socket Address structure.">SOCKADDR</a> *)&amp;addr, <span class="keyword">sizeof</span>(addr));</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (type == <a class="code" href="rl__net_8h.html#a249394484f9410a2e3f8eba24657feb9" title="BSD Socket Type.">SOCK_STREAM</a>) {</div>
<div class="line">      <a class="code" href="group__bsd__routines.html#ga7005ffbeeff92be5394ff3244da79028" title="Set a socket in a listening mode.">listen</a> (sock, 1);</div>
<div class="line">      sd = <a class="code" href="group__bsd__routines.html#ga18e88467cfdbc3c361d53b9f928a87ab" title="Accept connect request for a listening socket.">accept</a> (sock, NULL, NULL);</div>
<div class="line">      <a class="code" href="group__bsd__routines.html#gad272c8891ecce101c35bf18e3dc03d38" title="Close socket and release socket descriptor.">closesocket</a> (sock);</div>
<div class="line">      sock = sd;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">while</span> (1) {</div>
<div class="line">      res = <a class="code" href="group__bsd__routines.html#gae13b0fcffdc4f2c181a1def0b641ead4" title="Receive data on already connected socket.">recv</a> (sock, dbuf, <span class="keyword">sizeof</span> (dbuf), 0);</div>
<div class="line">      <span class="keywordflow">if</span> (res &lt;= 0) {</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">      }</div>
<div class="line">      <span class="keywordflow">if</span> (dbuf[0] == BLINKLED) {</div>
<div class="line">        LED_Out (dbuf[1]);</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">    <a class="code" href="group__bsd__routines.html#gad272c8891ecce101c35bf18e3dc03d38" title="Close socket and release socket descriptor.">closesocket</a> (sock);</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
</div>
<a class="anchor" id="gac6b00a29e8f1664d7ba4a70bfb92d9db"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int recvfrom </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>sock</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__bsd__routines.html#struct_s_o_c_k_a_d_d_r">SOCKADDR</a> *&#160;</td>
          <td class="paramname"><em>from</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>fromlen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Receive data from endpoint node. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">sock</td><td>socket descriptor obtained with <a class="el" href="group__bsd__routines.html#gabd21dff339393ec8e83b439d1120df71">socket</a>. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">buf</td><td>pointer to application data buffer to store the data to. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">len</td><td>size of application data buffer (in bytes). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">flags</td><td>message flags:<ul>
<li>MSG_DONTWAIT = don't wait for data,</li>
<li>MSG_PEEK = peek at incoming data,</li>
<li>0 = for none. </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">from</td><td>structure containing remote IP address and port. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fromlen</td><td>length of <a class="el" href="group__bsd__routines.html#struct_s_o_c_k_a_d_d_r">SOCKADDR</a> structure. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>status information:<ul>
<li>Number of bytes received or</li>
<li>BSD_ERROR_SOCKET = Socket invalid or in invalid state.</li>
<li>BSD_ERROR_CLOSED = Remote node has closed the connection.</li>
<li>BSD_ERROR_WOULDBLOCK = Function would block in non-blocking mode.</li>
<li>BSD_ERROR_TIMEOUT = Wait for data timeout in blocking mode.</li>
<li>BSD_ERROR_LOCKED = Socket is locked by another task. </li>
</ul>
</dd></dl>
<dl class="section note"><dt>Note</dt><dd>Parameters <b>from</b> and <b>fromlen</b> are ignored for SOCK_STREAM socket type.</dd></dl>
<p>The function <b>recvfrom</b> is used to receive data that has been queued for a socket. It is normally used to receive messages on <b>SOCK_DGRAM</b> socket type, but can also be used to receive a reliable, ordered stream of data on a connected <b>SOCK_STREAM</b> socket type. It reads as much information as currently available up to the size of the buffer specified.</p>
<p>In blocking mode, which is enabled if the system detects RTX environment, this functions waits for received data. In non blocking mode, you must call the <b>recvfrom</b> function again if the error code BSD_ERROR_WOULDBLOCK is returned.</p>
<p>The argument <em>sock</em> specifies a socket descriptor returned from a previous call to <a class="el" href="group__bsd__routines.html#gabd21dff339393ec8e83b439d1120df71">socket</a>.</p>
<p>The argument <em>buf</em> is a pointer to the application data buffer for storing the data to. If the available data is too large to fit in the supplied application buffer <em>buf</em>, excess bytes are discarded in case of <b>SOCK_DGRAM</b> sockets. For socket types <b>SOCK_STREAM</b>, the data is buffered internally so the application can retrieve all data by multiple calls of <b>recvfrom</b> function.</p>
<p>The argument <em>len</em> specifies the size of the application data buffer.</p>
<p>The argument <em>flags</em> specifies the message flags:</p>
<table class="doxtable">
<tr>
<th>Flag </th><th>Description</th></tr>
<tr>
<td>MSG_DONTWAIT</td><td>The function returns with error code <code>BSD_ERROR_WOULDBLOCK</code> or <b>number of bytes</b> sent instead of blocking the socket. </td></tr>
<tr>
<td>MSG_PEEK </td><td>The function peeks at incoming data. The data is copied into the buffer, but is not removed from the input queue. </td></tr>
</table>
<p>The argument <em>from</em> is a pointer to the <a class="el" href="group__bsd__routines.html#struct_s_o_c_k_a_d_d_r" title="Generic Socket Address structure.">SOCKADDR</a> structure. If <em>from</em> is not <code>NULL</code>, the source IP address and port number of the datagram is filled in.</p>
<p>The argument <em>fromlen</em> is a pointer to the address length. It should initially contain the amount of space pointed to by <em>from</em>. On return it contains the actual length of the address returned in bytes.</p>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>You must call the <a class="el" href="group__bsd__routines.html#gabd21dff339393ec8e83b439d1120df71">socket</a> function before any other function calls to the BSD socket.</li>
<li>If a negative number is returned, it represents an error code.</li>
<li>The number of bytes actually read can be less than <em>len</em>.</li>
</ul>
</dd></dl>
<p><b>Code Example</b> </p>
<div class="fragment"><div class="line"><span class="comment">//----------------------------------------------------------------------------</span></div>
<div class="line"><span class="comment">//  Thread &#39;Server&#39;: BSD Server socket process</span></div>
<div class="line"><span class="comment">//----------------------------------------------------------------------------</span></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> Server (<span class="keywordtype">void</span> <span class="keyword">const</span> *arg) {</div>
<div class="line">  <a class="code" href="rl__net_8h.html#struct_s_o_c_k_a_d_d_r___i_n" title="IPv4 Socket Address structure.">SOCKADDR_IN</a> addr;</div>
<div class="line">  <span class="keywordtype">int</span> sock, sd, res, addrlen;</div>
<div class="line">  <span class="keywordtype">int</span> type = (int)arg;</div>
<div class="line">  <span class="keywordtype">char</span> dbuf[4];</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">while</span> (1) {</div>
<div class="line">    sock = <a class="code" href="group__bsd__routines.html#gabd21dff339393ec8e83b439d1120df71" title="Create a communication endpoint called socket.">socket</a> (<a class="code" href="rl__net_8h.html#a9930604d0e32588eae76f43ca38e7826" title="Internet Address Family (UDP, TCP)">AF_INET</a>, type, 0);</div>
<div class="line"></div>
<div class="line">    addr.<a class="code" href="rl__net_8h.html#a17c017619a9612c083063a3438ac4b5e" title="Port.">sin_port</a>        = <a class="code" href="rl__net_8h.html#af3a256b18d0645af51564e63fec1bbbb">htons</a>(PORT_NUM);</div>
<div class="line">    addr.<a class="code" href="rl__net_8h.html#a321ed882a4b4cd66d1b9ad64ababd67e" title="Socket domain.">sin_family</a>      = <a class="code" href="rl__net_8h.html#a3f5da0b5be27fe31ec7cc11bfa8d1a25" title="Internet Address Family (UDP, TCP)">PF_INET</a>;</div>
<div class="line">    addr.<a class="code" href="rl__net_8h.html#a92b552b33b68a46c97a8d27a13a8bfb6" title="IP address.">sin_addr</a>.s_addr = <a class="code" href="rl__net_8h.html#a5d1940045dc2e7de552f3d4ff13a74ab" title="BSD Internet Addresses.">INADDR_ANY</a>;</div>
<div class="line"></div>
<div class="line">    <a class="code" href="group__bsd__routines.html#ga03a7134a282d45095ea30edb8e1cd076" title="Assign a local address and port to a socket.">bind</a> (sock, (<a class="code" href="group__bsd__routines.html#struct_s_o_c_k_a_d_d_r" title="Generic Socket Address structure.">SOCKADDR</a> *)&amp;addr, <span class="keyword">sizeof</span>(addr));</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (type == <a class="code" href="rl__net_8h.html#a249394484f9410a2e3f8eba24657feb9" title="BSD Socket Type.">SOCK_STREAM</a>) {</div>
<div class="line">      <a class="code" href="group__bsd__routines.html#ga7005ffbeeff92be5394ff3244da79028" title="Set a socket in a listening mode.">listen</a> (sock, 1);</div>
<div class="line">      sd = <a class="code" href="group__bsd__routines.html#ga18e88467cfdbc3c361d53b9f928a87ab" title="Accept connect request for a listening socket.">accept</a> (sock, NULL, NULL);</div>
<div class="line">      <a class="code" href="group__bsd__routines.html#gad272c8891ecce101c35bf18e3dc03d38" title="Close socket and release socket descriptor.">closesocket</a> (sock);</div>
<div class="line">      sock = sd;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">while</span> (1) {</div>
<div class="line">    addrlen = <span class="keyword">sizeof</span> (addr);</div>
<div class="line">      res = <a class="code" href="group__bsd__routines.html#gac6b00a29e8f1664d7ba4a70bfb92d9db" title="Receive data from endpoint node.">recvfrom</a> (sock, dbuf, <span class="keyword">sizeof</span> (dbuf), 0, addr, &amp;addrlen);</div>
<div class="line">      <span class="keywordflow">if</span> (res &lt;= 0) {</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">      }</div>
<div class="line">      procrec ((uint8_t *)dbuf);</div>
<div class="line">      printf (<span class="stringliteral">&quot;Remote IP: %d.%d.%d.%d\n&quot;</span>,addr.<a class="code" href="rl__net_8h.html#a92b552b33b68a46c97a8d27a13a8bfb6" title="IP address.">sin_addr</a>.s_b1,</div>
<div class="line">                                         addr.<a class="code" href="rl__net_8h.html#a92b552b33b68a46c97a8d27a13a8bfb6" title="IP address.">sin_addr</a>.s_b2,</div>
<div class="line">                                         addr.<a class="code" href="rl__net_8h.html#a92b552b33b68a46c97a8d27a13a8bfb6" title="IP address.">sin_addr</a>.s_b3,</div>
<div class="line">                                         addr.<a class="code" href="rl__net_8h.html#a92b552b33b68a46c97a8d27a13a8bfb6" title="IP address.">sin_addr</a>.s_b4);</div>
<div class="line">      printf (<span class="stringliteral">&quot;Remote port: %d\n&quot;</span>,<a class="code" href="rl__net_8h.html#aaf82f29d63af29bd83e76d8f7122cf47">ntohs</a> (addr.<a class="code" href="rl__net_8h.html#a17c017619a9612c083063a3438ac4b5e" title="Port.">sin_port</a>));</div>
<div class="line">    }</div>
<div class="line">    <a class="code" href="group__bsd__routines.html#gad272c8891ecce101c35bf18e3dc03d38" title="Close socket and release socket descriptor.">closesocket</a> (sock);</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
</div>
<a class="anchor" id="ga27f7859e634a2cd0ab98219b5092f7f7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int send </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>sock</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Send data on already connected socket. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">sock</td><td>socket descriptor obtained with <a class="el" href="group__bsd__routines.html#gabd21dff339393ec8e83b439d1120df71">socket</a>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">buf</td><td>pointer to application data buffer to transmit. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">len</td><td>length of data (in bytes). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">flags</td><td>message flags:<ul>
<li>MSG_DONTWAIT = don't wait to send data,</li>
<li>0 = for none. </li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>status information:<ul>
<li>Number of bytes sent or</li>
<li>BSD_ERROR_SOCKET = Socket invalid or in invalid state.</li>
<li>BSD_ERROR_PARAMETER = Invalid or not supported parameters.</li>
<li>BSD_ERROR_WOULDBLOCK = Function would block in non-blocking mode.</li>
<li>BSD_ERROR_CLOSED = Remote node has closed the connection.</li>
<li>BSD_ERROR = Error in underlying native socket.</li>
<li>BSD_ERROR_LOCKED = Socket is locked by another task.</li>
</ul>
</dd></dl>
<p>The function <b>send</b> is used to send data on an already connected socket. This function is normally used to send a reliable, ordered stream of data bytes on a <b>SOCK_STREAM</b> socket type. It can also be used to send datagrams on a <b>SOCK_DGRAM</b> socket types.</p>
<p>The argument <em>sock</em> specifies a socket descriptor returned from a previous call to <a class="el" href="group__bsd__routines.html#gabd21dff339393ec8e83b439d1120df71">socket</a>.</p>
<p>The argument <em>buf</em> is a pointer to the application data buffer containing data to transmit. The buffer data length is not limited in size. If the data length is too large for one packet, the <b>send</b> function will fragment the data and send it in several successive data packets:</p>
<ul>
<li>In blocking mode, which is enabled if the system detects RTX environment, this function returns after the data has been successfully transmitted.</li>
<li>In non blocking mode, the function returns immediately without blocking the system. Return value represents the number of bytes sent, which can be less than <em>len</em>, if the data can not be transmitted in one packet.</li>
</ul>
<p>The argument <em>len</em> specifies the length of data in bytes. The argument <em>flags</em> specifies the message flags:</p>
<table class="doxtable">
<tr>
<th>Flag </th><th>Description</th></tr>
<tr>
<td>MSG_DONTWAIT</td><td>The function returns with error code <code>BSD_ERROR_WOULDBLOCK</code> or <b>number of bytes</b> sent instead of blocking the socket </td></tr>
</table>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>You must call the <a class="el" href="group__bsd__routines.html#gabd21dff339393ec8e83b439d1120df71">socket</a> function before any other function calls to the BSD socket.</li>
<li>If a negative number is returned, it represents an error code.</li>
</ul>
</dd></dl>
<p><b>Code Example</b> </p>
<div class="fragment"><div class="line"><span class="comment">//----------------------------------------------------------------------------</span></div>
<div class="line"><span class="comment">//  Thread &#39;Client&#39;: BSD Client socket process</span></div>
<div class="line"><span class="comment">//----------------------------------------------------------------------------</span></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> Client (<span class="keywordtype">void</span> <span class="keyword">const</span> *arg) {</div>
<div class="line">  <a class="code" href="rl__net_8h.html#struct_s_o_c_k_a_d_d_r___i_n" title="IPv4 Socket Address structure.">SOCKADDR_IN</a> addr;</div>
<div class="line">  <span class="keywordtype">int</span> sock, res;</div>
<div class="line">  <span class="keywordtype">char</span> dbuf[4];</div>
<div class="line">  uint8_t p2val,lshf;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">while</span> (1) {</div>
<div class="line">    sock = <a class="code" href="group__bsd__routines.html#gabd21dff339393ec8e83b439d1120df71" title="Create a communication endpoint called socket.">socket</a> (<a class="code" href="rl__net_8h.html#a9930604d0e32588eae76f43ca38e7826" title="Internet Address Family (UDP, TCP)">AF_INET</a>, SOCKTYPE, 0);</div>
<div class="line"></div>
<div class="line">    addr.<a class="code" href="rl__net_8h.html#a17c017619a9612c083063a3438ac4b5e" title="Port.">sin_port</a>      = <a class="code" href="rl__net_8h.html#af3a256b18d0645af51564e63fec1bbbb">htons</a>(PORT_NUM);</div>
<div class="line">    addr.<a class="code" href="rl__net_8h.html#a321ed882a4b4cd66d1b9ad64ababd67e" title="Socket domain.">sin_family</a>    = <a class="code" href="rl__net_8h.html#a3f5da0b5be27fe31ec7cc11bfa8d1a25" title="Internet Address Family (UDP, TCP)">PF_INET</a>;</div>
<div class="line">    addr.<a class="code" href="rl__net_8h.html#a92b552b33b68a46c97a8d27a13a8bfb6" title="IP address.">sin_addr</a>.s_b1 = IP1;</div>
<div class="line">    addr.<a class="code" href="rl__net_8h.html#a92b552b33b68a46c97a8d27a13a8bfb6" title="IP address.">sin_addr</a>.s_b2 = IP2;</div>
<div class="line">    addr.<a class="code" href="rl__net_8h.html#a92b552b33b68a46c97a8d27a13a8bfb6" title="IP address.">sin_addr</a>.s_b3 = IP3;</div>
<div class="line">    addr.<a class="code" href="rl__net_8h.html#a92b552b33b68a46c97a8d27a13a8bfb6" title="IP address.">sin_addr</a>.s_b4 = IP4;</div>
<div class="line"></div>
<div class="line">    <a class="code" href="group__bsd__routines.html#gadced863676ed93d1334ba8abef937dd1" title="Connect a socket to a remote host.">connect</a> (sock, (<a class="code" href="group__bsd__routines.html#struct_s_o_c_k_a_d_d_r" title="Generic Socket Address structure.">SOCKADDR</a> *)&amp;addr, <span class="keyword">sizeof</span> (addr));</div>
<div class="line"></div>
<div class="line">    lshf  = 1;</div>
<div class="line">    p2val = 0x01;</div>
<div class="line">    <span class="keywordflow">while</span> (1) {</div>
<div class="line">      <span class="comment">// Shift the LEDs </span></div>
<div class="line">      LED_Out (p2val);</div>
<div class="line">      p2val = lshf ? (p2val &lt;&lt; 1) : (p2val &gt;&gt; 1);</div>
<div class="line">      <span class="keywordflow">if</span> (p2val == 0x80) lshf = 0;</div>
<div class="line">      <span class="keywordflow">if</span> (p2val == 0x01) lshf = 1;</div>
<div class="line">    </div>
<div class="line">      <span class="comment">// Send the data to LED Server. </span></div>
<div class="line">      dbuf[0] = BLINKLED;</div>
<div class="line">      dbuf[1] = p2val;</div>
<div class="line">      res = <a class="code" href="group__bsd__routines.html#ga27f7859e634a2cd0ab98219b5092f7f7" title="Send data on already connected socket.">send</a> (sock, (<span class="keywordtype">char</span> *)&amp;dbuf, 2, 0);</div>
<div class="line">      <span class="keywordflow">if</span> (res &lt; 0) {</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">      }</div>
<div class="line">      osDelay (100 * SPEED);</div>
<div class="line">    }</div>
<div class="line">    <a class="code" href="group__bsd__routines.html#gad272c8891ecce101c35bf18e3dc03d38" title="Close socket and release socket descriptor.">closesocket</a> (sock);</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
</div>
<a class="anchor" id="gac238092843e59c729b6904b18eeeff77"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int sendto </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>sock</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__bsd__routines.html#struct_s_o_c_k_a_d_d_r">SOCKADDR</a> *&#160;</td>
          <td class="paramname"><em>to</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>tolen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Send data to endpoint node. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">sock</td><td>socket descriptor obtained with <a class="el" href="group__bsd__routines.html#gabd21dff339393ec8e83b439d1120df71">socket</a>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">buf</td><td>pointer to application data buffer to transmit. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">len</td><td>length of data (in bytes). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">flags</td><td>message flags:<ul>
<li>MSG_DONTWAIT = don't wait to send data,</li>
<li>0 = for none. </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">to</td><td>structure containing remote IP address and port. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tolen</td><td>length of <a class="el" href="group__bsd__routines.html#struct_s_o_c_k_a_d_d_r">SOCKADDR</a> structure. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>status information:<ul>
<li>Number of bytes sent or</li>
<li>BSD_ERROR_SOCKET = Socket invalid or in invalid state.</li>
<li>BSD_ERROR_PARAMETER = Invalid or not supported parameters.</li>
<li>BSD_ERROR_WOULDBLOCK = Function would block in non-blocking mode.</li>
<li>BSD_ERROR_CLOSED = Remote node has closed the connection.</li>
<li>BSD_ERROR = Error in underlying native socket.</li>
<li>BSD_ERROR_LOCKED = Socket is locked by another task. </li>
</ul>
</dd></dl>
<dl class="section note"><dt>Note</dt><dd>Parameters <b>to</b> and <b>tolen</b> are ignored for SOCK_STREAM socket type.</dd></dl>
<p>The function <b>sendto</b> is used to send data on a <b>SOCK_DGRAM</b> socket type.</p>
<p>The argument <em>sock</em> specifies a socket descriptor returned from a previous call to <a class="el" href="group__bsd__routines.html#gabd21dff339393ec8e83b439d1120df71">socket</a>.</p>
<p>The argument <em>buf</em> is a pointer to the application data buffer containing data to transmit. The buffer data length is not limited in size. If the data length is too large for one packet, the <b>sendto</b> function will fragment the data and send it in several successive data packets:</p>
<ul>
<li>In blocking mode, which is enabled if the system detects RTX environment, this function returns after the data has been successfully transmitted.</li>
<li>In non blocking mode, the function returns immediately without blocking the system. Return value represents the number of bytes sent, which can be less than <em>len</em>, if the data can not be transmitted in one packet.</li>
</ul>
<p>The argument <em>len</em> specifies the length of data in bytes. The argument <em>flags</em> specifies the message flags: </p>
<table class="doxtable">
<tr>
<th>Flag </th><th>Description</th></tr>
<tr>
<td>MSG_DONTWAIT</td><td>The function returns with error code <code>BSD_ERROR_WOULDBLOCK</code> or <b>number of bytes</b> sent instead of blocking the socket </td></tr>
</table>
<p>The argument <em>to</em> is a pointer to the <a class="el" href="group__bsd__routines.html#struct_s_o_c_k_a_d_d_r" title="Generic Socket Address structure.">SOCKADDR</a> structure that contains the end point node IP address and port number. The argument <em>tolen</em> specifies the length of <a class="el" href="group__bsd__routines.html#struct_s_o_c_k_a_d_d_r" title="Generic Socket Address structure.">SOCKADDR</a> structure.</p>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>You must call the <a class="el" href="group__bsd__routines.html#gabd21dff339393ec8e83b439d1120df71">socket</a> function before any other function calls to the BSD socket.</li>
<li>If a negative number is returned, it represents an error code.</li>
</ul>
</dd></dl>
<p><b>Code Example</b> </p>
<div class="fragment"><div class="line"><span class="comment">//----------------------------------------------------------------------------</span></div>
<div class="line"><span class="comment">//  Thread &#39;Client&#39;: BSD Client socket process</span></div>
<div class="line"><span class="comment">//----------------------------------------------------------------------------</span></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> Client (<span class="keywordtype">void</span> <span class="keyword">const</span> *arg) {</div>
<div class="line">  <a class="code" href="rl__net_8h.html#struct_s_o_c_k_a_d_d_r___i_n" title="IPv4 Socket Address structure.">SOCKADDR_IN</a> addr;</div>
<div class="line">  <span class="keywordtype">int</span> sock, res;</div>
<div class="line">  <span class="keywordtype">char</span> dbuf[4];</div>
<div class="line">  uint8_t p2val,lshf;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">while</span> (1) {</div>
<div class="line">    sock = <a class="code" href="group__bsd__routines.html#gabd21dff339393ec8e83b439d1120df71" title="Create a communication endpoint called socket.">socket</a> (<a class="code" href="rl__net_8h.html#a9930604d0e32588eae76f43ca38e7826" title="Internet Address Family (UDP, TCP)">AF_INET</a>, SOCKTYPE, 0);</div>
<div class="line"></div>
<div class="line">    addr.<a class="code" href="rl__net_8h.html#a17c017619a9612c083063a3438ac4b5e" title="Port.">sin_port</a>      = <a class="code" href="rl__net_8h.html#af3a256b18d0645af51564e63fec1bbbb">htons</a>(PORT_NUM);</div>
<div class="line">    addr.<a class="code" href="rl__net_8h.html#a321ed882a4b4cd66d1b9ad64ababd67e" title="Socket domain.">sin_family</a>    = <a class="code" href="rl__net_8h.html#a3f5da0b5be27fe31ec7cc11bfa8d1a25" title="Internet Address Family (UDP, TCP)">PF_INET</a>;</div>
<div class="line">    addr.<a class="code" href="rl__net_8h.html#a92b552b33b68a46c97a8d27a13a8bfb6" title="IP address.">sin_addr</a>.s_b1 = IP1;</div>
<div class="line">    addr.<a class="code" href="rl__net_8h.html#a92b552b33b68a46c97a8d27a13a8bfb6" title="IP address.">sin_addr</a>.s_b2 = IP2;</div>
<div class="line">    addr.<a class="code" href="rl__net_8h.html#a92b552b33b68a46c97a8d27a13a8bfb6" title="IP address.">sin_addr</a>.s_b3 = IP3;</div>
<div class="line">    addr.<a class="code" href="rl__net_8h.html#a92b552b33b68a46c97a8d27a13a8bfb6" title="IP address.">sin_addr</a>.s_b4 = IP4;</div>
<div class="line"></div>
<div class="line">    <a class="code" href="group__bsd__routines.html#gadced863676ed93d1334ba8abef937dd1" title="Connect a socket to a remote host.">connect</a> (sock, (<a class="code" href="group__bsd__routines.html#struct_s_o_c_k_a_d_d_r" title="Generic Socket Address structure.">SOCKADDR</a> *)&amp;addr, <span class="keyword">sizeof</span> (addr));</div>
<div class="line"></div>
<div class="line">    lshf  = 1;</div>
<div class="line">    p2val = 0x01;</div>
<div class="line">    <span class="keywordflow">while</span> (1) {</div>
<div class="line">      <span class="comment">// Shift the LEDs </span></div>
<div class="line">      LED_Out (p2val);</div>
<div class="line">      p2val = lshf ? (p2val &lt;&lt; 1) : (p2val &gt;&gt; 1);</div>
<div class="line">      <span class="keywordflow">if</span> (p2val == 0x80) lshf = 0;</div>
<div class="line">      <span class="keywordflow">if</span> (p2val == 0x01) lshf = 1;</div>
<div class="line">    </div>
<div class="line">      <span class="comment">// Send the data to LED Server. </span></div>
<div class="line">      dbuf[0] = BLINKLED;</div>
<div class="line">      dbuf[1] = p2val;</div>
<div class="line">      res = <a class="code" href="group__bsd__routines.html#gac238092843e59c729b6904b18eeeff77" title="Send data to endpoint node.">sendto</a> (sock, (<span class="keywordtype">char</span> *)&amp;dbuf, 2, 0, (<a class="code" href="group__bsd__routines.html#struct_s_o_c_k_a_d_d_r" title="Generic Socket Address structure.">SOCKADDR</a> *)&amp;to, <span class="keyword">sizeof</span> (to));</div>
<div class="line">      <span class="keywordflow">if</span> (res &lt; 0) {</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">      }</div>
<div class="line">      osDelay (100 * SPEED);</div>
<div class="line">    }</div>
<div class="line">    <a class="code" href="group__bsd__routines.html#gad272c8891ecce101c35bf18e3dc03d38" title="Close socket and release socket descriptor.">closesocket</a> (sock);</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
</div>
<a class="anchor" id="gabd21dff339393ec8e83b439d1120df71"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int socket </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>family</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>protocol</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create a communication endpoint called socket. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">family</td><td>address family:<ul>
<li>AF_INET = address family internet. </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">type</td><td>connection type of a socket:<ul>
<li>SOCK_STREAM = connection based type,</li>
<li>SOCK_DGRAM = datagram connectionless type. </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">protocol</td><td>protocol type:<ul>
<li>IPPROTO_TCP = must be used with SOCK_STREAM type</li>
<li>IPPROTO_UDP = must be used with SOCK_DGRAM TYPE,</li>
<li>0 = for system auto-select. </li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>status information:<ul>
<li>Socket descriptor identification number or</li>
<li>BSD_ERROR_PARAMETER = Invalid or not supported parameters.</li>
<li>BSD_ERROR = Allocate socket failed.</li>
</ul>
</dd></dl>
<p>The function <b>socket</b> creates a communication end point called a socket.</p>
<p>The argument <em>family</em> specifies the address family. Currently the only acceptable value is AF_INET.</p>
<p>The argument <em>type</em> specifies the communication semantics. The following are the currently supported types: </p>
<table class="doxtable">
<tr>
<th>Type </th><th>Description </th></tr>
<tr>
<td>SOCK_STREAM</td><td>Provides a reliable connection based data stream that is full-duplex </td></tr>
<tr>
<td>SOCK_DGRAM </td><td>Provides connectionless communication that is unreliable </td></tr>
</table>
<p>The argument <em>protocol</em> specifies the protocol that must be used with socket type: </p>
<table class="doxtable">
<tr>
<th>Protocol </th><th>Description </th></tr>
<tr>
<td>IPPROTO_TCP</td><td>Must be used with SOCK_STREAM socket type </td></tr>
<tr>
<td>IPPROTO_UDP</td><td>Must be used with SOCK_DGRAM socket type </td></tr>
<tr>
<td>0 </td><td>The system selects a matching protocol for the socket type </td></tr>
</table>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>You must call the <b>socket</b> function before any other function calls to the BSD socket.</li>
<li>If a negative number is returned, it represents an <b>error</b> <b>code</b>.</li>
</ul>
</dd></dl>
<p><b>Code Example</b> </p>
<div class="fragment"><div class="line"><span class="comment">//----------------------------------------------------------------------------</span></div>
<div class="line"><span class="comment">//  Thread &#39;Server&#39;: BSD Server socket process</span></div>
<div class="line"><span class="comment">//----------------------------------------------------------------------------</span></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> Server (<span class="keywordtype">void</span> <span class="keyword">const</span> *arg) {</div>
<div class="line">  <a class="code" href="rl__net_8h.html#struct_s_o_c_k_a_d_d_r___i_n" title="IPv4 Socket Address structure.">SOCKADDR_IN</a> addr;</div>
<div class="line">  <span class="keywordtype">int</span> sock, sd, res;</div>
<div class="line">  <span class="keywordtype">int</span> type = (int)arg;</div>
<div class="line">  <span class="keywordtype">char</span> dbuf[4];</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">while</span> (1) {</div>
<div class="line">    sock = <a class="code" href="group__bsd__routines.html#gabd21dff339393ec8e83b439d1120df71" title="Create a communication endpoint called socket.">socket</a> (<a class="code" href="rl__net_8h.html#a9930604d0e32588eae76f43ca38e7826" title="Internet Address Family (UDP, TCP)">AF_INET</a>, type, 0);</div>
<div class="line"></div>
<div class="line">    addr.<a class="code" href="rl__net_8h.html#a17c017619a9612c083063a3438ac4b5e" title="Port.">sin_port</a>        = <a class="code" href="rl__net_8h.html#af3a256b18d0645af51564e63fec1bbbb">htons</a>(PORT_NUM);</div>
<div class="line">    addr.<a class="code" href="rl__net_8h.html#a321ed882a4b4cd66d1b9ad64ababd67e" title="Socket domain.">sin_family</a>      = <a class="code" href="rl__net_8h.html#a3f5da0b5be27fe31ec7cc11bfa8d1a25" title="Internet Address Family (UDP, TCP)">PF_INET</a>;</div>
<div class="line">    addr.<a class="code" href="rl__net_8h.html#a92b552b33b68a46c97a8d27a13a8bfb6" title="IP address.">sin_addr</a>.s_addr = <a class="code" href="rl__net_8h.html#a5d1940045dc2e7de552f3d4ff13a74ab" title="BSD Internet Addresses.">INADDR_ANY</a>;</div>
<div class="line"></div>
<div class="line">    <a class="code" href="group__bsd__routines.html#ga03a7134a282d45095ea30edb8e1cd076" title="Assign a local address and port to a socket.">bind</a> (sock, (<a class="code" href="group__bsd__routines.html#struct_s_o_c_k_a_d_d_r" title="Generic Socket Address structure.">SOCKADDR</a> *)&amp;addr, <span class="keyword">sizeof</span>(addr));</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (type == <a class="code" href="rl__net_8h.html#a249394484f9410a2e3f8eba24657feb9" title="BSD Socket Type.">SOCK_STREAM</a>) {</div>
<div class="line">      <a class="code" href="group__bsd__routines.html#ga7005ffbeeff92be5394ff3244da79028" title="Set a socket in a listening mode.">listen</a> (sock, 1);</div>
<div class="line">      sd = <a class="code" href="group__bsd__routines.html#ga18e88467cfdbc3c361d53b9f928a87ab" title="Accept connect request for a listening socket.">accept</a> (sock, NULL, NULL);</div>
<div class="line">      <a class="code" href="group__bsd__routines.html#gad272c8891ecce101c35bf18e3dc03d38" title="Close socket and release socket descriptor.">closesocket</a> (sock);</div>
<div class="line">      sock = sd;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">while</span> (1) {</div>
<div class="line">      res = <a class="code" href="group__bsd__routines.html#gae13b0fcffdc4f2c181a1def0b641ead4" title="Receive data on already connected socket.">recv</a> (sock, dbuf, <span class="keyword">sizeof</span> (dbuf), 0);</div>
<div class="line">      <span class="keywordflow">if</span> (res &lt;= 0) {</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">      }</div>
<div class="line">      <span class="keywordflow">if</span> (dbuf[0] == BLINKLED) {</div>
<div class="line">        LED_Out (dbuf[1]);</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">    <a class="code" href="group__bsd__routines.html#gad272c8891ecce101c35bf18e3dc03d38" title="Close socket and release socket descriptor.">closesocket</a> (sock);</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Thu Feb 20 2014 15:12:43 for Network Component by ARM Ltd. All rights reserved.
	<!--
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.2 
	-->
	</li>
  </ul>
</div>
</body>
</html>
