;version 1.03, 01/15/2013, Copyright P&E Microcomputer Systems, www.pemicro.com [mk_64k_dx_pflash_dflash_eeprom_p0]
;device freescale, k20dx64, pflash_dflash_eeprom_50mhz
;begin_cs device=$00000000, length=$14000800, ram=$20000000
;end_cs
REQUIRES_PROG_VERSION=1.17/
NO_ON_CHIP_RAM
DO_MASS_ERASE_AND_RESET       ;Perform MDM Mass erase
NO_TIMING_TEST                
PRESERVE_PARTITION            ;Preserve Partition through erase               
WRITE_LONG=00FF003F/4001F000/ ;Disable Master0..2 prefetching
WRITE_LONG=30020000/4001F004/ ;Disable Cache and Prefetching on Flash Bank 0
WRITE_LONG=30020000/4001F008/ ;Disable Cache and Prefetching on Flash Bank 1
WRITE_LONG=FFFFFFFF/40020010/ ;All PFlash protection off
WRITE_WORD=FFFF/40020016/     ;All DFlash and EEPROM protection off
BLANK_MODULE_ONLY
BOUNDARY_MASK=FFFFF800/
BLOCKING_MASK=00000003/
NO_BASE_ADDRESS=00000000/
ADDR_RANGE=00000000/0000FFFF/00/FFFFFFFC/FFFFF800/     ; $00000000-$0000FFFF P-Flash
ADDR_RANGE=10000000/10007FFF/00/FFFFFFFC/FFFFF800/     ; $10000000-$10007FFF D-Flash
ADDR_RANGE=14000000/140007FF/00/FFFFFFFC/FFFFF800/     ; $14000000-$140007FF EEPROM if partitioned
TEST_VALUE=00/0000040C/00000033/00000020/00/003/007/Data that is about to be programmed will permanently secure the device. Continue?/ 
TEST_VALUE=00/0000040C/00000033/00000021/00/003/007/Data that is about to be programmed will permanently secure the device. Continue?/ 
TEST_VALUE=00/0000040C/00000033/00000023/00/003/007/Data that is about to be programmed will permanently secure the device. Continue?/
; turn off watchdog timer
WRITE_LONG=4005200E/1FFFFF00/ ; dc32 0x4005200E      ;wdog unlock address
WRITE_LONG=40052000/1FFFFF04/ ; dc32 0x40052000      ;wdog control_h
WRITE_LONG=500CF85F/1FFFFF08/ ; ldr  r5,w_unlock_loc ;get wdog unlock address 
WRITE_LONG=600CF85F/1FFFFF0C/ ; ldr  r6,w_control_h  ;get wdog control address
WRITE_LONG=5820F24C/1FFFFF10/ ; mov  r8,#0xC520      ;get constants
WRITE_LONG=1928F64D/1FFFFF14/ ; mov  r9,#0xD928
WRITE_LONG=0A02F04F/1FFFFF18/ ; mov  r10,#0x0002
WRITE_LONG=8000F8A5/1FFFFF1C/ ; strh r8,[r5]         ;unlock wdog
WRITE_LONG=9000F8A5/1FFFFF20/ ; strh r9,[r5]
WRITE_WORD=BF00/1FFFFF24/     ; nop                  ;timing
WRITE_LONG=A000F8A6/1FFFFF26/ ; strh r10,[r6]        ;turn wdog off
WRITE_WORD=BE00/1FFFFF2A/     ; bkpt #0x0 
SET_PC_AND_RUN=1FFFFF08/      ; disable software watchdog
PUT_REGFILE=00/1FFFFF00/              ;Address in SRAM_LOW for timing routine
ICS_RANGE=000312500/000382000/000006400/ ICS Range (LSB = decimal place)
09BIT_TRIM=40064002/40064003/01/000003FF/000003FE/01400000/
USER=SD Secure Device      0          /00000000/00000000/
USER=PA Partition          4ERPART:DE>/00000000/00003F0B/ ER<=$3F, DE<=$0B

S02800006D6B5F36346B5F64785F70666C6173685F64666C6173685F656570726F6D5F70302E733139F1
S31520000000D0040020D00C00200008000000000000D2
S315200000100008001400000000AC01002000000000D1
S31520000020000000007201002024020020240200208B
S31520000030D4000020D6000020FA0000200000000096
S31520000040000000000000000060030020780300206C
S31520000050008000000060000000400000000000005A
S31520000060000000000000000000000000000000006A
S31520000070000000000020000000400000008000007A
S3152000008000000000000000000000000000800000CA
S315200000900000000000000000000000000008000032
S315200000A000040000000200000001000080000000A3
S315200000B040000000200000000000000000000000BA
S315200000C0000000000000000000000000000000000A
S315200000D029E000BE00BE00BE4FF070062E70F34E23
S315200000E0EE804FF080062E7000BF2E7816F0800628
S315200000F0FBD02A7812F07002F746DD4D002909D090
S315200001000FF2862808F10108C0472A7812F07002FB
S31520000110002A1FD10FF2A02808F10108C04712F0CB
S315200001207002002A16D1D94C002C04D0DFA64FF439
S315200001300147378003E0DDA648F2FF173780AFF28C
S31520000140680808F10108C04712F07002002A01D1A0
S31520000150D74E00BEC94AD64E00BE4FF00402D64B3B
S31520000160D14FD7F80080C34E08EA06061E60CE4956
S3152000017058E04FF070062E704FF04406EE714FF0A7
S3152000018080062E7000BF2E7816F08006FBD02A78C7
S3152000019012F07002002A08D10FF21C2808F101087B
S315200001A0C04712F07002002AD7D000BEBE4E4FF6CE
S315200001B0FF774FF6FE794FF000014FF480328A46E2
S315200001C031F8028BB24503D1C84529D1921EF6E7F4
S315200001D0B84525D1921EF2D1AD49AE4A002A05D0A6
S315200001E031F8028BB8451BD1921EF9D1A649A74CEE
S315200001F0002C15D0ADA64FF401473780AFF2281852
S3152000020008F10108C04712F07002002A08D12246E0
S315200002104FF6FF7731F8028BB84501D1921EF9D1FE
S31520000220A34E00BE14464FF070062E709A4EB14271
S315200002301DDB9EA64FF401473780AFF2641808F104
S315200002400108C04712F07002002A0ED153F804AB01
S3152000025041F804AB6E7816F00106FBD02A7812F02E
S31520000260700202D1241F002CF0D1914E00BE8FA621
S3152000027048F2FF173780AFF2A01808F10108C047EF
S3152000028012F07002002A69D17D4F01EA0707BB46AA
S31520000290BBF5803F03DB2BF0805B4BF4000B4FF468
S315200002A00079864E57F804AB46F804ABB9F101093C
S315200002B0F8D14FF070062E70C5F804B04FF009063D
S315200002C0EE714FF080062E7000BF2E7816F0800655
S315200002D0FBD02A7812F0700240D1784E0F46DFF814
S315200002E0A48107EA08073E44DFF8D09109F50069A2
S315200002F053F804AB46F804AB01F10401241F02D0E5
S315200003004E4500D0F4E74FF400786C4F624E4FF420
S31520000310807957F804AB46F804ABB9F10109F8D156
S315200003204FF480766E81C5F804B04FF00B06EE715F
S315200003304FF080062E7000BF2E7816F08006FBD078
S315200003402A7812F0700209D10BF5806BB8F5807807
S31520000350B8F1000FDAD1002C7FF496AF544E00BED0
S315200003604FF00402544B504FD7F80080424E08EA13
S3152000037006061E604C4955E743F60F7634404CA6D8
S3152000038034604FF000024A4E00BE4FF070072F70C7
S315200003904FF08007EF7106F47C574FEA1727EF726C
S315200003A006F00F07AF724FF080072F7000BF2F782F
S315200003B017F08007FBD0F7464FF070062E703D4CA5
S315200003C06C604FF00306EE714FF00006EE734FF0AF
S315200003D080062E7000BF2E7816F08006FBD02A7875
S315200003E012F070022C8943F60F76344030A6346022
S315200003F04FEA142404F00F044FEA8404AFF2703657
S3152000040026443468002C0AD020A63460224E234C81
S3152000041026441E4CA6EB04061BA4266005E04FF0DE
S31520000420000619A4266019A42660214C14F00F0496
S315200004300F2C0ED0002C0CD0082C13D0072C11D04A
S315200004404FEA8404AFF2F8362644346811A63460A5
S315200004500CE010A44FF40046266015A443F60B7654
S31520000460266003E00BA44FF000062660F746000046
S3152000047000000240FEFFFFFFFCFFFFFFFFFFFFFF24
S3152000048000F8FFFFFF07000000000000000000004A
S31520000490000000100080000000000014000800008A
S315200004A000000000000800140C040000FF8100007A
S315200004B00B3F0000FC008000D00C0020D004002060
S315200004C00E200540002005405FF80C505FF80C60B8
S315200004D04CF220584DF628194FF0020AA5F8008054
S311200004E0A5F8009000BFA6F800A000BE02
S70520000000DA
½