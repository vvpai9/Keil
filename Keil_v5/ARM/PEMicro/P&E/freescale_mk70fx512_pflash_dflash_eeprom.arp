;version 1.06, 03/13/2013, Copyright P&E Microcomputer Systems, www.pemicro.com [mk_512k_x_pflash_dflash_eeprom]
;device freescale, mk70fx512, pflash_dflash_eeprom
;begin_cs device=$00000000, length=$14004000, ram=$20000000
;end_cs
REQUIRES_PROG_VERSION=1.17/
NO_ON_CHIP_RAM
DO_MASS_ERASE_AND_RESET       ;Perform MDM Mass erase
NO_TIMING_TEST  
PRESERVE_PARTITION            ;Preserve Partition through erase              
WRITE_LONG=00FF003F/4001F000/ ;Disable Master0..2 prefetching
WRITE_LONG=30020000/4001F004/ ;Disable Cache and Prefetching on Flash Bank 0
WRITE_LONG=30020000/4001F008/ ;Disable Cache and Prefetching on Flash Bank 1
WRITE_LONG=FFFFFFFF/40020010/ ;All PFlash protection off
WRITE_WORD=FFFF/40020016/     ;All DFlash and EEPROM protection off
BLANK_MODULE_ONLY
BOUNDARY_MASK=FFFFE000/
BLOCKING_MASK=00000003/
NO_BASE_ADDRESS=00000000/
ADDR_RANGE=00000000/0007FFFF/00/FFFFFFFC/FFFFF800/     ; $00000000-$0007FFFF P-Flash
ADDR_RANGE=10000000/1007FFFF/00/FFFFFFFC/FFFFF800/     ; $10000000-$1007FFFF D-Flash
ADDR_RANGE=14000000/14003FFF/00/FFFFFFFC/FFFFF800/     ; $14000000-$14003FFF EEPROM if partitioned
TEST_VALUE=00/0000040C/00000033/00000020/00/003/007/Data that is about to be programmed will permanently secure the device. Continue?/ 
TEST_VALUE=00/0000040C/00000033/00000021/00/003/007/Data that is about to be programmed will permanently secure the device. Continue?/ 
TEST_VALUE=00/0000040C/00000033/00000023/00/003/007/Data that is about to be programmed will permanently secure the device. Continue?/ 
; turn off watchdog timer
WRITE_LONG=4005200E/1FFFFF00/ ; dc32 0x4005200E      ;wdog unlock address
WRITE_LONG=40052000/1FFFFF04/ ; dc32 0x40052000      ;wdog control_h
WRITE_LONG=500CF85F/1FFFFF08/ ; ldr  r5,w_unlock_loc ;get wdog unlock address 
WRITE_LONG=600CF85F/1FFFFF0C/ ; ldr  r6,w_control_h  ;get wdog control address
WRITE_LONG=5820F24C/1FFFFF10/ ; mov  r8,#0xC520      ;get constants
WRITE_LONG=1928F64D/1FFFFF14/ ; mov  r9,#0xD928
WRITE_LONG=0A02F04F/1FFFFF18/ ; mov  r10,#0x0002
WRITE_LONG=8000F8A5/1FFFFF1C/ ; strh r8,[r5]         ;unlock wdog
WRITE_LONG=9000F8A5/1FFFFF20/ ; strh r9,[r5]
WRITE_WORD=BF00/1FFFFF24/     ; nop                  ;timing
WRITE_LONG=A000F8A6/1FFFFF26/ ; strh r10,[r6]        ;turn wdog off
WRITE_WORD=BE00/1FFFFF2A/     ; bkpt #0x0 
SET_PC_AND_RUN=1FFFFF08/      ; disable software watchdog
PUT_REGFILE=00/1FFFFF00/      ;Address in SRAM_LOW for timing routine
ICS_RANGE=000312500/000382000/000006400/ ICS Range (LSB = decimal place)
09BIT_TRIM=40064002/40064003/01/000003FF/000003FE/01400000/
USER=SD Secure Device      0          /00000000/00000000/
USER=PA Partition          4ERPART:DE>/00000000/00003F0F/ ER<=$3F, DE<=$0F
COMMENT1="PA" Partition Command must be followed by "EM" Erase Module Command

S02500006D6B5F3531326B5F785F70666C6173685F64666C6173685F656570726F6D2E73313929
S3152000000098040020B8040020002000000000000012
S315200000100040001400000000AC0100200000000099
S31520000020000000008201002024020020240200207B
S31520000030D4000020D6000020FA0000200000000096
S31520000040D0000020000000002E03002046030020E0
S315200000500000080000000000000000000000000072
S315200000600000070000000600000004000000000059
S31520000070000000000000000000000000000000005A
S31520000080000001000000020000000400000008003B
S3152000009000400000002000000010000000080000C2
S315200000A000040000000200000001000080000000A3
S315200000B040000000200000000000000000000000BA
S315200000C0000000000000000000000000000000000A
S315200000D031E000BE00BE00BE4FF070062E70E64E28
S315200000E0EE804FF080062E7000BF2E7816F0800628
S315200000F0FBD02A7812F07002F746D04D002911D095
S3152000010043F60F7106EA010643F60F77BE4209D081
S315200001100FF2442808F10108C0472A7812F070022D
S31520000120002A1FD10FF25E2808F10108C04712F0FD
S315200001307002002A16D1C84C002C04D0CEA64FF44B
S315200001400147378003E0CCA648F2FF173780AFF28D
S31520000150780808F10108C04712F07002002A01D180
S31520000160C64E00BEB84AC54E00BE4FF00402C54B6F
S31520000170C04FD7F80080B24E08EA06061E60BD4979
S3152000018050E04FF070062E704FF04406EE714FF09F
S3152000019080062E7000BF2E7816F08006FBD02A78B7
S315200001A012F07002002A00D1DFD000BEB14E4FF609
S315200001B0FF774FF6FE794FF000014FF400228A4672
S315200001C031F8028BB24503D1C84529D1921EF6E7F4
S315200001D0B84525D1921EF2D1A049A14A002A1FD0A6
S315200001E031F8028BB8451BD1921EF9D199499A4C08
S315200001F0002C15D0A0A64FF401473780AFF228185F
S3152000020008F10108C04712F07002002A08D12246E0
S315200002104FF6FF7731F8028BB84501D1921EF9D1FE
S31520000220964E00BE14464FF070062E708D4EB1428B
S315200002301CDB91A64FF401473780AFF2641808F112
S315200002400108C04712F07002002A6ED153F804ABA1
S3152000025041F804AB6E7816F00106FBD02A7812F02E
S31520000260700262D1241F002CF0D15EE082A648F2F3
S31520000270FF173780AFF2A01808F10108C04712F027
S315200002807002002A51D1714F01EA0707BB46BBF520
S31520000290002F03DB2BF0805B4BF4000B4FF48069BF
S315200002A0704E57F804AB46F804ABB9F10109F8D102
S315200002B04FF070062E70C5F804B04FF00906EE71A7
S315200002C04FF080062E7000BF2E7816F08006FBD0E9
S315200002D02A7812F0700228D1624E0F46DFF870811C
S315200002E007EA08073E4453F804AB46F804AB01F18D
S315200002F00401241F03D016EA080900D0F3E74FF4BF
S3152000030080766E81C5F804B04FF00B06EE714FF083
S3152000031080062E7000BF2E7816F08006FBD02A7835
S3152000032012F0700201D1002CADD1544E00BE4FF018
S315200003300402544B4F4FD7F80080424E08EA060677
S315200003401E604C496EE743F60F7634404BA6346068
S315200003504FF00002494E00BE4FF070072F704FF04D
S315200003608007EF7106F47C574FEA1727EF7206F0E5
S315200003700F07AF724FF080072F7000BF2F7817F04E
S315200003808007FBD0F7464FF070062E703C4C6C6011
S315200003904FF00306EE714FF00006EE724FF0800626
S315200003A02E7000BF2E7816F08006FBD02A7812F029
S315200003B07002AC8943F60F76344030A634604FEA9B
S315200003C0142404F00F044FEA8404AFF23C3626448A
S315200003D03468002C0AD020A63460224E224C2644B3
S315200003E01D4CA6EB04061BA4266005E04FF0000674
S315200003F018A4266018A42660204C14F00F040F2C95
S315200004000ED0002C0CD0082C13D0072C11D04FEA7C
S315200004108404AFF2C4362644346811A634600CE056
S315200004200FA44FF40026266014A443F60F76266008
S3152000043003E00BA44FF000062660F74600000240BA
S31520000440FEFFFFFFFCFFFFFFFFFFFFFF00F0FFFFA8
S31520000450FF0F000000000000000000000000001058
S31520000460000008000000001400400000000000000A
S31520000470004000140C040000FF8100000F3F000024
S31520000480F8038000B80400200E2005400020054017
S315200004905FF80C505FF80C604CF220584DF6281986
S315200004A04FF0020AA5F80080A5F8009000BFA6F834
S309200004B000A000BEC4
S70520000000DA
©9