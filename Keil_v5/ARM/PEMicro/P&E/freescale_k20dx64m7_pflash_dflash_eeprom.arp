;version 1.01, 01/15/2013, Copyright P&E Microcomputer Systems, www.pemicro.com [mk_64k_dx_pflash_dflash_eeprom_p1]
;device freescale, k20dx64m7, pflash_dflash_eeprom
;begin_cs device=$00000000, length=$14000800, ram=$20000000
;end_cs
REQUIRES_PROG_VERSION=1.17/
NO_ON_CHIP_RAM
DO_MASS_ERASE_AND_RESET       ;Perform MDM Mass erase
NO_TIMING_TEST                
PRESERVE_PARTITION            ;Preserve Partition through erase               
WRITE_LONG=00FF003F/4001F000/ ;Disable Master0..2 prefetching
WRITE_LONG=30020000/4001F004/ ;Disable Cache and Prefetching on Flash Bank 0
WRITE_LONG=30020000/4001F008/ ;Disable Cache and Prefetching on Flash Bank 1
WRITE_LONG=FFFFFFFF/40020010/ ;All PFlash protection off
WRITE_WORD=FFFF/40020016/     ;All DFlash and EEPROM protection off
BLANK_MODULE_ONLY
BOUNDARY_MASK=FFFFF800/
BLOCKING_MASK=00000003/
NO_BASE_ADDRESS=00000000/
ADDR_RANGE=00000000/0000FFFF/00/FFFFFFFC/FFFFF800/     ; $00000000-$0000FFFF P-Flash
ADDR_RANGE=10000000/10007FFF/00/FFFFFFFC/FFFFF800/     ; $10000000-$10007FFF D-Flash
ADDR_RANGE=14000000/140007FF/00/FFFFFFFC/FFFFF800/     ; $14000000-$140007FF EEPROM if partitioned
TEST_VALUE=00/0000040C/00000033/00000020/00/003/007/Data that is about to be programmed will permanently secure the device. Continue?/ 
TEST_VALUE=00/0000040C/00000033/00000021/00/003/007/Data that is about to be programmed will permanently secure the device. Continue?/ 
TEST_VALUE=00/0000040C/00000033/00000023/00/003/007/Data that is about to be programmed will permanently secure the device. Continue?/
; turn off watchdog timer
WRITE_LONG=4005200E/1FFFFF00/ ; dc32 0x4005200E      ;wdog unlock address
WRITE_LONG=40052000/1FFFFF04/ ; dc32 0x40052000      ;wdog control_h
WRITE_LONG=500CF85F/1FFFFF08/ ; ldr  r5,w_unlock_loc ;get wdog unlock address 
WRITE_LONG=600CF85F/1FFFFF0C/ ; ldr  r6,w_control_h  ;get wdog control address
WRITE_LONG=5820F24C/1FFFFF10/ ; mov  r8,#0xC520      ;get constants
WRITE_LONG=1928F64D/1FFFFF14/ ; mov  r9,#0xD928
WRITE_LONG=0A02F04F/1FFFFF18/ ; mov  r10,#0x0002
WRITE_LONG=8000F8A5/1FFFFF1C/ ; strh r8,[r5]         ;unlock wdog
WRITE_LONG=9000F8A5/1FFFFF20/ ; strh r9,[r5]
WRITE_WORD=BF00/1FFFFF24/     ; nop                  ;timing
WRITE_LONG=A000F8A6/1FFFFF26/ ; strh r10,[r6]        ;turn wdog off
WRITE_WORD=BE00/1FFFFF2A/     ; bkpt #0x0 
SET_PC_AND_RUN=1FFFFF08/      ; disable software watchdog
PUT_REGFILE=00/1FFFFF00/              ;Address in SRAM_LOW for timing routine
ICS_RANGE=000312500/000382000/000006400/ ICS Range (LSB = decimal place)
09BIT_TRIM=40064002/40064003/01/000003FF/000003FE/01400000/
USER=SD Secure Device      0          /00000000/00000000/
USER=PA Partition          4ERPART:DE>/00000000/00003F0B/ ER<=$3F, DE<=$0B

S02800006D6B5F36346B5F64785F70666C6173685F64666C6173685F656570726F6D5F70312E733139F0
S31520000000D4040020D40C00200008000000000000CA
S315200000100008001400000000740100200000000009
S315200000200000000072010020EC010020EC010020FD
S31520000030D4000020D6000020FA0000200000000096
S315200000400000000000000000660300207E03002060
S31520000050008000000060000000400000000000005A
S31520000060000000000000000000000000000000006A
S31520000070000000000020000000400000008000007A
S3152000008000000000000000000000000000800000CA
S315200000900000000000000000000000000008000032
S315200000A000040000000200000001000080000000A3
S315200000B040000000200000000000000000000000BA
S315200000C0000000000000000000000000000000000A
S315200000D029E000BE00BE00BE4FF070062E70F44E22
S315200000E0EE804FF080062E7000BF2E7816F0800628
S315200000F0FBD02A7812F07002F746DE4D002909D08F
S315200001000FF28C2808F10108C0472A7812F07002F5
S31520000110002A1FD10FF2A62808F10108C04712F0C5
S315200001207002002A16D1DA4C002C04D0E0A64FF437
S315200001300147378003E0DEA648F2FF173780AFF28B
S31520000140680808F10108C04712F07002002A01D1A0
S31520000150D84E00BECA4AD74E00BE4FF00402D74B37
S31520000160D24FD7F80080C44E08EA06061E60CF4953
S315200001703CE000BECD4E4FF6FF774FF6FE794FF0AE
S3152000018000014FF480328A4631F8028BB24503D102
S31520000190C84529D1921EF6E7B84525D1921EF2D13F
S315200001A0BC49BD4A002A05D031F8028BB8451BD17F
S315200001B0921EF9D1B549B64C002C15D0BCA64FF4E9
S315200001C001473780AFF2F00808F10108C04712F066
S315200001D07002002A08D122464FF6FF7731F8028BAB
S315200001E0B84501D1921EF9D1B24E00BE14464FF049
S315200001F070062E70A94EB1421DDBADA64FF4014705
S315200002003780AFF22C1808F10108C04712F07002AF
S31520000210002A0ED153F804AB41F804AB6E7816F0E1
S315200002200106FBD02A7812F0700202D1241F002C7E
S31520000230F0D1A04E00BE9EA648F2FF173780AFF23F
S31520000240681808F10108C04712F07002002AF0D1A0
S315200002508C4F01EA0707BB46BBF5803F03DB2BF03B
S31520000260805B4BF4000B4FF40079954E57F804ABA6
S3152000027046F804ABB9F10109F8D14FF070062E709B
S31520000280C5F804B04FF00906EE714FF080062E70C7
S3152000029000BF2E7816F08006FBD02A7812F0700266
S315200002A05FD1BBF5000F15DB4FF070062E700BF5F6
S315200002B08068C5F804804FF00906EE714FF080067D
S315200002C02E7000BF2E7816F08006FBD02A7812F00A
S315200002D0700246D17A4E0F46DFF8AC8107EA08074E
S315200002E03E44DFF8DC9109F5006953F804AB46F883
S315200002F004AB01F10401241F02D04E4500D0F4E7DF
S315200003004FF400786E4F654E4FF4807957F804AB62
S3152000031046F804ABB9F10109F8D1BBF5000F02DBB1
S315200003204FF4807601E04FF080066E81C5F804B068
S315200003304FF00B06EE714FF080062E7000BF2E7820
S3152000034016F08006FBD02A7812F0700209D10BF540
S31520000350806BB8F58078B8F1000FD4D1002C7FF4EB
S3152000036077AF544E00BE4FF00402544B4F4FD7F890
S315200003700080424E08EA06061E604C4936E743F6E0
S315200003800F7634404BA634604FF00002494E00BE33
S315200003904FF070072F704FF08007EF7106F47C57EF
S315200003A04FEA1727EF7206F00F07AF724FF080075C
S315200003B02F7000BF2F7817F08007FBD0F7464FF03D
S315200003C070062E703C4C6C604FF00306EE714FF0B9
S315200003D00006EE734FF080062E7000BF2E7816F0C2
S315200003E08006FBD02A7812F070022C8943F60F760D
S315200003F0344030A634604FEA142404F00F044FEA48
S315200004008404AFF2743626443468002C0AD020A621
S315200004103460224E224C26441D4CA6EB04061BA417
S31520000420266005E04FF0000618A4266018A4266072
S31520000430204C14F00F040F2C0ED0002C0CD0082CBE
S3152000044013D0072C11D04FEA8404AFF2FC36264491
S31520000450346811A634600CE00FA44FF400462660E1
S3152000046014A443F60B76266003E00BA44FF0000697
S315200004702660F74600000240FEFFFFFFFCFFFFFF5D
S31520000480FFFFFFFF00F8FFFFFF070000000000004E
S315200004900000000000000010008000000000001492
S315200004A00008000000000000000800140C040000F2
S315200004B0FF8100000B3F0000FC008000D40C0020D0
S315200004C0D40400200E200540002005405FF80C5083
S315200004D05FF80C604CF220584DF628194FF0020AAE
S315200004E0A5F80080A5F8009000BFA6F800A000BEE1
S70520000000DA
p