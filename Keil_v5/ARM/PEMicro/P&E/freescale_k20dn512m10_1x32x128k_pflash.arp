;version 1.10, 05/29/2012, Copyright P&E Microcomputer Systems, www.pemicro.com [mk_512k_n_pflash0_pflash1]
;device freescale, k20dn512m10, 1x32x128k, desc=pflash
;begin_cs device=$00000000, length=$00080000, ram=$20000000
;end_cs
REQUIRES_PROG_VERSION=1.03/
NO_ON_CHIP_RAM
DO_MASS_ERASE_AND_RESET       ;Perform MDM Mass erase
NO_TIMING_TEST 
WRITE_LONG=00FF003F/4001F000/ ;Disable Master0..2 prefetching
WRITE_LONG=30020000/4001F004/ ;Disable Cache and Prefetching on Flash Bank 0
WRITE_LONG=30020000/4001F008/ ;Disable Cache and Prefetching on Flash Bank 1
WRITE_LONG=FFFFFFFF/40020010/ ;All PFlash protection off
BLANK_MODULE_ONLY
BOUNDARY_MASK=FFFFE000/
BLOCKING_MASK=00000003/
NO_BASE_ADDRESS=00000000/
ADDR_RANGE=00000000/0007FFFF/00/FFFFFFFC/FFFFF800/     ; $00000000-$0007FFFF P-Flash
TEST_VALUE=00/0000040C/00000033/00000020/00/003/007/Data that is about to be programmed will permanently secure the device. Continue?/ 
TEST_VALUE=00/0000040C/00000033/00000021/00/003/007/Data that is about to be programmed will permanently secure the device. Continue?/ 
TEST_VALUE=00/0000040C/00000033/00000023/00/003/007/Data that is about to be programmed will permanently secure the device. Continue?/
; turn off watchdog timer
WRITE_LONG=4005200E/1FFFFF00/ ; dc32 0x4005200E      ;wdog unlock address
WRITE_LONG=40052000/1FFFFF04/ ; dc32 0x40052000      ;wdog control_h
WRITE_LONG=500CF85F/1FFFFF08/ ; ldr  r5,w_unlock_loc ;get wdog unlock address 
WRITE_LONG=600CF85F/1FFFFF0C/ ; ldr  r6,w_control_h  ;get wdog control address
WRITE_LONG=5820F24C/1FFFFF10/ ; mov  r8,#0xC520      ;get constants
WRITE_LONG=1928F64D/1FFFFF14/ ; mov  r9,#0xD928
WRITE_LONG=0A02F04F/1FFFFF18/ ; mov  r10,#0x0002
WRITE_LONG=8000F8A5/1FFFFF1C/ ; strh r8,[r5]         ;unlock wdog
WRITE_LONG=9000F8A5/1FFFFF20/ ; strh r9,[r5]
WRITE_WORD=BF00/1FFFFF24/     ; nop                  ;timing
WRITE_LONG=A000F8A6/1FFFFF26/ ; strh r10,[r6]        ;turn wdog off
WRITE_WORD=BE00/1FFFFF2A/     ; bkpt #0x0 
SET_PC_AND_RUN=1FFFFF08/      ; disable software watchdog
PUT_REGFILE=00/1FFFFF00/              ;Address in SRAM_LOW for timing routine
ICS_RANGE=000312500/000390625/000006400/ ICS Range (LSB = decimal place)
09BIT_TRIM=40064002/40064003/01/000003FF/000003FE/01400000/
;Sectors  128-2k (00..7F) PFlash0
USER=P0 Sector Erase PFl0  2Page >    /00000000/0000007F/
;Sectors  128-2k (00..7F) PFlash1
USER=P1 Sector Erase PFl1  2Page >    /00000000/0000007F/
USER=EA Erase All          0Page >    /00000000/00000000/
; Be Carefull. Normally you do not want to use this command since it erases
; the PFlash, DFlash, FlexRAM, EEPROM, and the DFlash IFR
USER=SD Secure Device      0          /00000000/00000000/

S02000006D6B5F3531326B5F6E5F70666C617368305F70666C617368312E733139B2
S31520000000640200208402002000100000000000008E
S315200000100000080000000000480100200000000049
S3152000002000000000B20000207201002072010020B2
S315200000305A0000205C0000205E0000200000000026
S315200000400000000000000000680000206E00002074
S315200000500A0100201202002000BE00BE00BE734D21
S315200000602A7812F0700200BE4FF0000301E04FF430
S3152000007080234FF4006604FB06F6194631444FF000
S3152000008070062E7069604FF00906EE714FF08006FB
S315200000902E7000BF2E7816F08006FBD02A7812F03C
S315200000A0700200D000BE002B00D000BE002C3FD036
S315200000B000BE4FF070062E704FF480266E604FF013
S315200000C00806EE714FF080062E7000BF2E7816F0CF
S315200000D08006FBD02A7812F0700200D000BE4FF0C6
S315200000E070062E704FF000066E604FF00806EE7117
S315200000F04FF080062E7000BF2E7816F08006FBD0BB
S315200001002A7812F0700213D000BE4FF070062E70BF
S315200001104FF04406EE714FF080062E7000BF2E7809
S3152000012016F08006FBD02A7812F0700200D000BEAE
S315200001304FF00402464B454FD7F800803C4E08EA64
S3152000014006061E60414914E0404E4FF6FF774FF6F3
S31520000150FE7931F8028BB84502D1921EF9D100BE44
S31520000160C845FCD1A1F10201B14201F10201F4D04E
S3152000017000BE14464FF070062E70304F01EA070776
S31520000180BB464FF40079304E57F804AB46F804AB23
S31520000190B9F10109F8D14FF070062E70C5F804B0F8
S315200001A04FF00906EE714FF080062E7000BF2E78B4
S315200001B016F08006FBD02A7812F0700228D1224E43
S315200001C00F46DFF87C8007EA08073E4453F804AB65
S315200001D046F804AB01F10401241F03D016EA0809EE
S315200001E000D0F3E74FF480766E81C5F804B04FF067
S315200001F00B06EE714FF080062E7000BF2E7816F09B
S315200002008006FBD02A7812F0700201D1002CB4D1DE
S3152000021000BE4FF004020E4B0C4FD7F80080054E5F
S3152000022008EA06061E600949A3E70000000002400E
S31520000230FEFFFFFFFCFFFFFFFFFFFFFF00F8FFFFB2
S31520000240FF07000000000000000000140C0400005E
S31520000250840200200E200540002005405FF80C5047
S315200002605FF80C604CF220584DF628194FF0020A20
S31520000270A5F80080A5F8009000BFA6F800A000BE53
S70520000000DA
[—