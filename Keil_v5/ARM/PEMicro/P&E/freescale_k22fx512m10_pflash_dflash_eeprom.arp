;version 1.00, 02/04/2013, Copyright P&E Microcomputer Systems, www.pemicro.com [mk22_512k_x_pflash_dflash_eeprom_m10]
;device freescale, k22fx512m10, pflash_dflash_eeprom
;begin_cs device=$00000000, length=$14004000, ram=$20000000
;end_cs
REQUIRES_PROG_VERSION=1.17/
NO_ON_CHIP_RAM
DO_MASS_ERASE_AND_RESET       ;Perform MDM Mass erase
NO_TIMING_TEST                
PRESERVE_PARTITION            ;Preserve Partition through erase              
WRITE_LONG=00FF003F/4001F000/ ;Disable Master0..2 prefetching
WRITE_LONG=30020000/4001F004/ ;Disable Cache and Prefetching on Flash Bank 0
WRITE_LONG=30020000/4001F008/ ;Disable Cache and Prefetching on Flash Bank 1
WRITE_LONG=FFFFFFFF/40020010/ ;All PFlash protection off
WRITE_WORD=FFFF/40020016/     ;All DFlash and EEPROM protection off
BLANK_MODULE_ONLY
BOUNDARY_MASK=FFFFE000/
BLOCKING_MASK=00000003/
NO_BASE_ADDRESS=00000000/
ADDR_RANGE=00000000/0007FFFF/00/FFFFFFFC/FFFFF800/     ; $00000000-$0007FFFF P-Flash
ADDR_RANGE=10000000/1001FFFF/00/FFFFFFFC/FFFFF800/     ; $10000000-$1001FFFF D-Flash
ADDR_RANGE=14000000/14000FFF/00/FFFFFFFC/FFFFF800/     ; $14000000-$14000FFF EEPROM if partitioned
TEST_VALUE=00/0000040C/00000033/00000020/00/003/007/Data that is about to be programmed will permanently secure the device. Continue?/ 
TEST_VALUE=00/0000040C/00000033/00000021/00/003/007/Data that is about to be programmed will permanently secure the device. Continue?/ 
TEST_VALUE=00/0000040C/00000033/00000023/00/003/007/Data that is about to be programmed will permanently secure the device. Continue?/ 
; turn off watchdog timer
WRITE_LONG=4005200E/1FFFFF00/ ; dc32 0x4005200E      ;wdog unlock address
WRITE_LONG=40052000/1FFFFF04/ ; dc32 0x40052000      ;wdog control_h
WRITE_LONG=500CF85F/1FFFFF08/ ; ldr  r5,w_unlock_loc ;get wdog unlock address 
WRITE_LONG=600CF85F/1FFFFF0C/ ; ldr  r6,w_control_h  ;get wdog control address
WRITE_LONG=5820F24C/1FFFFF10/ ; mov  r8,#0xC520      ;get constants
WRITE_LONG=1928F64D/1FFFFF14/ ; mov  r9,#0xD928
WRITE_LONG=0A02F04F/1FFFFF18/ ; mov  r10,#0x0002
WRITE_LONG=8000F8A5/1FFFFF1C/ ; strh r8,[r5]         ;unlock wdog
WRITE_LONG=9000F8A5/1FFFFF20/ ; strh r9,[r5]
WRITE_WORD=BF00/1FFFFF24/     ; nop                  ;timing
WRITE_LONG=A000F8A6/1FFFFF26/ ; strh r10,[r6]        ;turn wdog off
WRITE_WORD=BE00/1FFFFF2A/     ; bkpt #0x0 
SET_PC_AND_RUN=1FFFFF08/      ; disable software watchdog
PUT_REGFILE=00/1FFFFF00/              ;Address in SRAM_LOW for timing routine
ICS_RANGE=000312500/000382000/000006400/ ICS Range (LSB = decimal place)
09BIT_TRIM=40064002/40064003/01/000003FF/000003FE/01400000/
USER=SD Secure Device      0          /00000000/00000000/
USER=PA Partition          4ERPART:DE>/00000000/00003F0F/ ER<=$3F, DE<=$0F
COMMENT1="PA" Partition Command must be followed by "EM" Erase Module Command

S02B00006D6B32325F3531326B5F785F70666C6173685F64666C6173685F656570726F6D5F6D31302E73313992
S31520000000D4040020F414002000200000000000008A
S315200000100010001400000000AC01002000000000C9
S31520000020000000007201002024020020240200208B
S31520000030D4000020D6000020FA0000200000000096
S31520000040D000002000000000620300207A03002078
S3152000005000000200000000000000000000800100F7
S315200000600000010000000000000000000000000069
S3152000007000000000000000000000000000800000DA
S315200000800000010000000200000000000000020045
S315200000900000000000000000001000000008000022
S315200000A000040000000200000001000080000000A3
S315200000B040000000200000000000000000000000BA
S315200000C0000000000000000000000000000000000A
S315200000D029E000BE00BE00BE4FF070062E70F34E23
S315200000E0EE804FF080062E7000BF2E7816F0800628
S315200000F0FBD02A7812F07002F746DD4D002909D090
S315200001000FF2882808F10108C0472A7812F07002F9
S31520000110002A1FD10FF2A22808F10108C04712F0C9
S315200001207002002A16D1D94C002C04D0DFA64FF439
S315200001300147378003E0DDA648F2FF173780AFF28C
S31520000140680808F10108C04712F07002002A01D1A0
S31520000150D74E00BEC94AD64E00BE4FF00402D64B3B
S31520000160D14FD7F80080C34E08EA06061E60CE4956
S3152000017058E04FF070062E704FF04406EE714FF0A7
S3152000018080062E7000BF2E7816F08006FBD02A78C7
S3152000019012F07002002A08D10FF21E2808F1010879
S315200001A0C04712F07002002AD7D000BEBE4E4FF6CE
S315200001B0FF774FF6FE794FF000014FF400228A4672
S315200001C031F8028BB24503D1C84529D1921EF6E7F4
S315200001D0B84525D1921EF2D1AD49AE4A002A05D0A6
S315200001E031F8028BB8451BD1921EF9D1A649A74CEE
S315200001F0002C15D0ADA64FF401473780AFF2281852
S3152000020008F10108C04712F07002002A08D12246E0
S315200002104FF6FF7731F8028BB84501D1921EF9D1FE
S31520000220A34E00BE14464FF070062E709C4EB1426F
S315200002301DDB9EA64FF401473780AFF2641808F104
S315200002400108C04712F07002002A0ED153F804AB01
S3152000025041F804AB6E7816F00106FBD02A7812F02E
S31520000260700202D1241F002CF0D1914E00BE8FA621
S3152000027048F2FF173780AFF2A01808F10108C047EF
S3152000028012F07002002A6AD17D4F01EA0707BB46A9
S315200002904FF48069894EBBF5002F03DB2BF0805B82
S315200002A04BF4000B57F804AB46F804ABB9F101093F
S315200002B0F8D14FF070062E70C5F804B04FF009063D
S315200002C0EE714FF080062E7000BF2E7816F0800655
S315200002D0FBD02A7812F0700241D1784E0F46DFF813
S315200002E0A48107EA08073E4453F804AB46F804AB5A
S315200002F001F10401241F06D04FF480586F4A42446E
S31520000300964200D0F0E74FF480586C4F4FF4806946
S31520000310634E57F804AB46F804ABB9F1040900D094
S31520000320F7E74FF040066E81C5F804B04FF00B0694
S31520000330EE714FF080062E7000BF2E7816F08006E4
S31520000340FBD02A7812F0700209D10BF5806BB8F534
S315200003508068B8F1000FD9D1002C7FF495AF544EA8
S3152000036000BE4FF00402544B4F4FD7F80080424E48
S3152000037008EA06061E604C4954E743F60F763440D9
S315200003804BA634604FF00002494E00BE4FF0700776
S315200003902F704FF08007EF7106F47C574FEA17272E
S315200003A0EF7206F00F07AF724FF080072F7000BF75
S315200003B02F7817F08007FBD0F7464FF070062E7087
S315200003C03C4C6C604FF00306EE714FF00006EE7267
S315200003D04FF080062E7000BF2E7816F08006FBD0D8
S315200003E02A7812F07002AC8943F60F76344030A694
S315200003F034604FEA142404F00F044FEA8404AFF269
S31520000400703626443468002C0AD020A63460244E48
S31520000410214C26441D4CA6EB04061BA4266005E0B1
S315200004204FF0000618A4266018A42660204C14F06D
S315200004300F040F2C0ED0002C0CD0082C13D0072C18
S3152000044011D04FEA8404AFF2F8362644346811A658
S3152000045034600CE00FA44FF40026266014A443F663
S315200004600D76266003E00BA44FF000062660F746C3
S3152000047000000240FEFFFFFFFCFFFFFFFFFFFFFF24
S3152000048000F0FFFFFF0F000000000000000000004A
S31520000490000000100000080000100000000000000E
S315200004A000000014001000140C040000FF8100005E
S315200004B00D3F0000F8038000F4140020F40400200F
S315200004C0001000000E200540002005405FF80C506B
S315200004D05FF80C604CF220584DF628194FF0020AAE
S315200004E0A5F80080A5F8009000BFA6F800A000BEE1
S70520000000DA
œk