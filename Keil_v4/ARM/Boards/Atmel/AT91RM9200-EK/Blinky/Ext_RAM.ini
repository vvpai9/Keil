/******************************************************************************/
/* Ext_RAM.INI: External RAM (SDRAM) Initialization File                      */
/******************************************************************************/
// <<< Use Configuration Wizard in Context Menu >>>                           // 
/******************************************************************************/
/* This file is part of the uVision/ARM development tools.                    */
/* Copyright (c) 2005-2006 Keil Software. All rights reserved.                */
/* This software may only be used under the terms of a valid, current,        */
/* end user licence from KEIL for a compatible version of KEIL software       */
/* development tools. Nothing else gives you the right to use this software.  */
/******************************************************************************/


FUNC void Setup (void) {

  _WDWORD(0xFFFFF804, 0xFFFF0000);      // PIOC_PDR: Enable Peripheral Mode  

  _WDWORD(0xFFFFFF60, 0x00000002);      // EBI_CSA: CSA1 support for SDRAM

  _WDWORD(0xFFFFFF98, 0x2188C155);      // Init SDRAM
  _WDWORD(0xFFFFFF90, 0x00000002);
  _WDWORD(0x20000000, 0);
  _WDWORD(0xFFFFFF90, 0x00000004);
  _WDWORD(0x20000000, 0);
  _WDWORD(0x20000000, 0);
  _WDWORD(0x20000000, 0);
  _WDWORD(0x20000000, 0);
  _WDWORD(0x20000000, 0);
  _WDWORD(0x20000000, 0);
  _WDWORD(0x20000000, 0);
  _WDWORD(0x20000000, 0);
  _WDWORD(0xFFFFFF90, 0x00000003);
  _WDWORD(0x20000080, 0);
  _WDWORD(0xFFFFFF94, 0x000002E0);
  _WDWORD(0x20000000, 0);
  _WDWORD(0xFFFFFF90, 0x00000000);
  _WDWORD(0x20000000, 0);

  // <o> Program Entry Point
  PC = 0x20000000;
}


// Switching from Slow Clock to Main Oscillator for faster Download
_WDWORD(0xFFFFFC20, 0x00000601);        // PMC_MOR: Enable Main Oscillator
_sleep_(10);                            // Wait for stable Main Oscillator
_WDWORD(0xFFFFFC30, 0x00000001);        // PMC_MCKR: Switch to Main Oscillator

Setup();                                // Setup for Init

LOAD Ext_RAM_Dbg\Blinky.axf INCREMENTAL // Download

g, main
